{"config":{"lang":["ja"],"separator":"[\\s\\-\uff0c\u3002]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"Kubean","text":"<p>Kubean \u662f\u4e00\u6b3e\u57fa\u4e8e kubespray \u7684\u96c6\u7fa4\u751f\u547d\u5468\u671f\u7ba1\u7406\u5de5\u5177\u3002</p>"},{"location":"#_1","title":"\u529f\u80fd\u8d85\u8d5e","text":"<ul> <li>\u7b80\u5355\u6613\u7528\uff1a\u901a\u8fc7\u58f0\u660e\u5f0f API \u5b9e\u73b0 Kubean \u548c K8s \u96c6\u7fa4\u5f3a\u52b2\u751f\u547d\u5468\u671f\u7ba1\u7406\u7684\u90e8\u7f72\u3002</li> <li>\u652f\u6301\u79bb\u7ebf\uff1a\u6bcf\u4e2a\u7248\u672c\u90fd\u4f1a\u53d1\u5e03\u79bb\u7ebf\u5305\uff08os-pkgs\u3001\u955c\u50cf\u3001\u4e8c\u8fdb\u5236\u5305\uff09\u3002\u4f60\u4e0d\u5fc5\u62c5\u5fc3\u5982\u4f55\u6536\u96c6\u6240\u9700\u7684\u8d44\u6e90\u3002</li> <li>\u517c\u5bb9\u6027\uff1a\u652f\u6301\u591a\u67b6\u6784\u4ea4\u4ed8\uff1aAMD\u3001ARM\uff1b\u5e38\u89c1\u7684 Linux \u53d1\u884c\u7248\uff1b\u4ee5\u53ca\u57fa\u4e8e\u9cb2\u9e4f\u6784\u5efa\u7684\u9e92\u9e9f\u64cd\u4f5c\u7cfb\u7edf\u3002</li> <li>\u53ef\u6269\u5c55\u6027\uff1a\u5141\u8bb8\u4f7f\u7528\u539f\u751f Kubespray \u81ea\u5b9a\u4e49\u96c6\u7fa4\u3002</li> </ul>"},{"location":"concepts/architecture/","title":"Kubean \u57fa\u7840\u67b6\u6784","text":"<p>Kubean \u7684\u6574\u4f53\u67b6\u6784\u5982\u4e0b\u6240\u793a\uff1a</p> <p></p> <p>Kubean \u9700\u8981\u8fd0\u884c\u5728\u4e00\u4e2a\u5df2\u5b58\u5728\u7684 Kubernetes \u96c6\u7fa4\uff0c\u901a\u8fc7\u5e94\u7528 Kubean \u63d0\u4f9b\u7684\u6807\u51c6 CRD \u8d44\u6e90\u548c Kubernetes \u5185\u5efa\u8d44\u6e90\u6765\u63a7\u5236\u548c\u7ba1\u7406\u96c6\u7fa4\u7684\u751f\u547d\u5468\u671f\uff08\u5b89\u88c5\u3001\u5378\u8f7d\u3001\u5347\u7ea7\u3001\u6269\u5bb9\u3001\u7f29\u5bb9\u7b49\uff09\u3002 Kubean \u91c7\u7528 Kubespray \u4f5c\u4e3a\u5e95\u5c42\u6280\u672f\u4f9d\u8d56\uff0c\u4e00\u65b9\u9762\u7b80\u5316\u4e86\u96c6\u7fa4\u90e8\u7f72\u7684\u64cd\u4f5c\u6d41\u7a0b\uff0c\u964d\u4f4e\u4e86\u7528\u6237\u7684\u4f7f\u7528\u95e8\u69db\u3002\u53e6\u4e00\u65b9\u9762\u5728 Kubespray \u80fd\u529b\u57fa\u7840\u4e0a\u589e\u52a0\u4e86\u96c6\u7fa4\u64cd\u4f5c\u8bb0\u5f55\u3001\u79bb\u7ebf\u7248\u672c\u8bb0\u5f55\u7b49\u8bf8\u591a\u65b0\u7279\u6027\u3002</p> <p></p> <p></p> <p>Kubean \u8fd0\u884c\u7740\u591a\u4e2a\u63a7\u5236\u5668\uff0c\u8fd9\u4e9b\u63a7\u5236\u5668\u8ddf\u8e2a Kubean CRD \u5bf9\u8c61\u7684\u53d8\u5316\uff0c\u5e76\u4e14\u4e0e\u5e95\u5c42\u96c6\u7fa4\u7684 API \u670d\u52a1\u5668\u8fdb\u884c\u901a\u4fe1\u6765\u521b\u5efa Kubernetes\u539f\u751f\u8d44\u6e90\u5bf9\u8c61\u3002\u7531\u4ee5\u4e0b\u56db\u4e2a\u7ec4\u4ef6\u6784\u6210\uff1a</p> <ol> <li>Cluster Controller: \u76d1\u89c6 <code>Cluster Objects</code>\u3002\u552f\u4e00\u6807\u8bc6\u4e00\u4e2a\u96c6\u7fa4\uff0c\u62e5\u6709\u96c6\u7fa4\u8282\u70b9\u7684\u8bbf\u95ee\u4fe1\u606f\u3001\u7c7b\u578b\u4fe1\u606f\u3001\u90e8\u7f72\u53c2\u6570\u4fe1\u606f\uff0c\u5e76\u4e14\u5173\u8054\u6240\u6709\u5bf9\u6b64\u96c6\u7fa4\u7684\u64cd\u4f5c\uff08<code>ClusterOperation Objects</code>\uff09\uff1b</li> <li>ClusterOperation Controller: \u76d1\u89c6 <code>ClusterOperation Objects</code>\u3002\u5f53 <code>ClusterOperation Object</code> \u88ab\u521b\u5efa\u65f6\uff0c\u63a7\u5236\u5668\u4f1a\u7ec4\u88c5\u4e00\u4e2a Job \u53bb\u6267\u884c CRD \u5bf9\u8c61\u91cc\u5b9a\u4e49\u7684\u64cd\u4f5c\uff1b</li> <li>Manifest Controller: \u76d1\u89c6 <code>Manifest Objects</code>\u3002\u7528\u4e8e\u8bb0\u5f55\u548c\u7ef4\u62a4\u5f53\u524d\u7248\u672c\u7684 Kubean \u4f7f\u7528\u548c\u517c\u5bb9\u7684\u7ec4\u4ef6\u3001\u5305\u53ca\u7248\u672c\uff1b</li> <li>LocalArtifactSet Controller\uff1a\u76d1\u89c6 <code>LocalArtifactSet Objects</code>\u3002\u7528\u4e8e\u8bb0\u5f55\u79bb\u7ebf\u5305\u652f\u6301\u7684\u7ec4\u4ef6\u53ca\u7248\u672c\u4fe1\u606f\u3002</li> </ol>"},{"location":"concepts/comparisons/","title":"\u5bf9\u6bd4\u53c2\u8003","text":""},{"location":"concepts/comparisons/#kubean-vs-kubespray","title":"Kubean vs Kubespray","text":"<p>Kubespray \u4f7f\u7528 Ansible \u4f5c\u4e3a\u5e95\u5c42\u6765\u914d\u7f6e\u548c\u7f16\u6392\uff0c\u53ef\u4ee5\u8fd0\u884c\u5728\u88f8\u91d1\u5c5e\u673a\u3001\u865a\u62df\u673a\u3001\u5927\u591a\u6570\u4e91\u73af\u5883\u7b49\u3002\u5b83\u652f\u6301\u4f17\u591a Kubernetes \u7248\u672c\u548c\u63d2\u4ef6\uff0c\u53ef\u4ee5\u5b8c\u6210\u96c6\u7fa4\u4ece 0 \u5230 1 \u7684\u642d\u5efa\u548c\u914d\u7f6e\uff0c\u4e5f\u5305\u542b\u96c6\u7fa4\u751f\u547d\u5468\u671f\u7684\u7ef4\u62a4\uff0c\u4f7f\u7528\u65b9\u5f0f\u975e\u5e38\u7075\u6d3b\u3002</p> <p>Kubean \u57fa\u4e8e Kubespray\uff0c\u62e5\u6709 Kubespray \u6240\u6709\u4f18\u52bf\u3002\u5e76\u4e14 Kubean \u5f15\u7528 Operator \u6982\u5ff5\u4ee5\u5b9e\u73b0\u5b8c\u5168\u4e91\u539f\u751f\u5316\uff0c\u539f\u751f\u4ee5\u5bb9\u5668\u65b9\u5f0f\u8fd0\u884c\uff0c\u63d0\u4f9b Helm Chart \u5305\u8fdb\u884c\u5feb\u901f\u90e8\u7f72\u3002</p> <p>Kubespray \u4ec5\u5728\u53c2\u6570\u7ea7\u522b\u4e0a\u652f\u6301\u79bb\u7ebf\uff0c\u5e76\u6ca1\u6709\u5305\u542b\u4e00\u4e2a\u5b8c\u6210\u6784\u5efa\u79bb\u7ebf\u5b89\u88c5\u5305\u7684\u8fc7\u7a0b\uff0c\u6240\u4ee5\u5bf9\u4e8e\u6709\u79bb\u7ebf\u573a\u666f\u9700\u6c42\u7684\u4f7f\u7528\u8005\u6765\u8bf4\uff0c\u76f4\u63a5\u4f7f\u7528 Kubespray \u4f1a\u53d8\u5f97\u975e\u5e38\u7e41\u7410\uff0c\u8fd9\u901a\u5e38\u4f1a\u8ba9\u4ed6\u4eec\u5931\u53bb\u8010\u5fc3\u3002</p> <p>Kubean \u4e0d\u4ec5\u6709\u4e00\u5957\u5b8c\u5584\u7684\u5236\u4f5c\u79bb\u7ebf\u5305\u7684\u5de5\u4f5c\u6d41\uff0c\u8fd8\u9002\u914d\u56fd\u4ea7\u4fe1\u521b\u73af\u5883\uff0c\u7b80\u5316 Kubespray \u7684\u590d\u6742\u914d\u7f6e\uff0c\u80fd\u591f\u5bf9\u96c6\u7fa4\u751f\u547d\u5468\u671f\u4ee5\u4e91\u539f\u751f\u7684\u65b9\u5f0f\u53bb\u7ba1\u7406\u3002</p>"},{"location":"concepts/crds/","title":"CRD \u6982\u8ff0","text":""},{"location":"concepts/crds/#cluster","title":"Cluster","text":"<p>Kubean \u5141\u8bb8\u901a\u8fc7 custom resource definitions (CRDs) \u6765\u58f0\u660e\uff08\u552f\u4e00\u6807\u8bc6\uff09\u4e00\u4e2a Kubernetes \u96c6\u7fa4\u3002\u6240\u6709\u5bf9\u96c6\u7fa4\u7684\u64cd\u4f5c\u90fd\u57fa\u4e8e\u6b64 CRD \u91cc\u58f0\u660e\u7684\u5185\u5bb9\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4efd\u793a\u4f8b\uff0c\u5e2e\u52a9\u7406\u89e3\u4e0b\u6587\u7684\u914d\u7f6e\u9879\u8bf4\u660e\uff1a</p> <pre><code>apiVersion: kubean.io/v1alpha1\nkind: Cluster\nmetadata:\nname: cluster1-offline-demo\nspec:\nhostsConfRef:\nnamespace: kubean-system\nname: cluster1-offline-demo-hosts-conf\nvarsConfRef:\nnamespace: kubean-system\nname: cluster1-offline-demo-vars-conf\n</code></pre>"},{"location":"concepts/crds/#_1","title":"\u914d\u7f6e\u9879","text":""},{"location":"concepts/crds/#_2","title":"\u5143\u6570\u636e","text":"<ul> <li><code>name</code>\uff1aname \u7528\u4e8e\u58f0\u660e\u4e00\u4e2a\u96c6\u7fa4\uff0c\u5168\u5c40\u552f\u4e00</li> </ul>"},{"location":"concepts/crds/#_3","title":"\u5c5e\u6027\u5173\u8054","text":"<ul> <li><code>hostConfRef</code>\uff1ahostConfRef \u662f\u4e00\u4e2a ConfigMap \u8d44\u6e90\uff0c\u5b83\u7684\u5185\u5bb9\u5e94\u6ee1\u8db3 ansible inventory \u7684\u683c\u5f0f\uff0c\u5305\u542b\u96c6\u7fa4\u8282\u70b9\u4fe1\u606f\u3001\u7c7b\u578b\u5206\u7ec4\u4fe1\u606f\u3002\u5185\u5bb9\u53ef\u53c2\u8003 demo\u3002</li> <li><code>name</code>\uff1a\u8868\u793a\u5176\u5f15\u7528\u7684 ConfigMap \u7684\u540d\u79f0</li> <li> <p><code>namespace</code>\uff1a\u8868\u793a\u5176\u5f15\u7528\u7684 ConfigMap \u6240\u5728\u7684\u547d\u540d\u7a7a\u95f4</p> </li> <li> <p><code>varsConfRef</code>\uff1avarsConfRef \u662f\u4e00\u4e2a ConfigMap \u8d44\u6e90\uff0c\u7528\u4f5c\u521d\u59cb\u5316\u6216\u8986\u76d6 Kubespray \u4e2d\u58f0\u660e\u7684\u53d8\u91cf\u503c\u3002\u5982\u679c\u6709\u79bb\u7ebf\u9700\u6c42\uff0c\u8fd9\u5c06\u5f88\u6709\u7528\u3002\u5185\u5bb9\u53ef\u53c2\u8003 demo\u3002</p> </li> <li><code>name</code>\uff1a\u8868\u793a\u5176\u5f15\u7528\u7684 ConfigMap \u7684\u540d\u79f0</li> <li> <p><code>namespace</code>\uff1a\u8868\u793a\u5176\u5f15\u7528\u7684 ConfigMap \u6240\u5728\u7684\u547d\u540d\u7a7a\u95f4</p> </li> <li> <p><code>sshAuthRef</code>\uff1asshAuthRef \u662f\u4e00\u4e2a Secret \u8d44\u6e90\uff0c\u4ec5\u5728 SSH \u79c1\u94a5\u6a21\u5f0f\u65f6\u4f7f\u7528\u3002</p> </li> <li><code>name</code>\uff1a\u8868\u793a\u5176\u5f15\u7528\u7684 Secret \u540d\u79f0</li> <li><code>namespace</code>\uff1a\u8868\u793a\u5176\u5f15\u7528\u7684 Secret \u6240\u5728\u7684\u547d\u540d\u7a7a\u95f4</li> </ul>"},{"location":"concepts/crds/#clusteroperation","title":"ClusterOperation","text":"<p>Kubean \u5141\u8bb8\u901a\u8fc7 custom resource definitions (CRDs) \u6765\u58f0\u660e\u5bf9\u4e00\u4e2a Kubernetes \u96c6\u7fa4\u7684\u64cd\u4f5c\uff08\u90e8\u7f72\u3001\u5347\u7ea7\u7b49\uff09\uff0c\u524d\u63d0\u662f\u6b63\u786e\u5173\u8054\u4e00\u4e2a\u5df2\u7ecf\u5b9a\u4e49\u7684 Cluster CRD\u3002\u5b8c\u6210\u64cd\u4f5c\u6240\u5fc5\u8981\u7684\u4fe1\u606f\u4ece\u5176\u5173\u8054\u7684 Cluster CRD \u4e2d\u83b7\u53d6\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4efd\u793a\u4f8b\uff0c\u5e2e\u52a9\u7406\u89e3\u4e0b\u6587\u7684\u914d\u7f6e\u9879\u8bf4\u660e\uff1a</p> <pre><code>apiVersion: kubean.io/v1alpha1\nkind: ClusterOperation\nmetadata:\nname: cluster1-demo-ops-1\nspec:\ncluster: cluster1-demo\nimage: ghcr.m.daocloud.io/kubean-io/spray-job:latest\nbackoffLimit: 0\nactionType: playbook\naction: cluster.yml\npreHook:\n- actionType: playbook\naction: ping.yml\n- actionType: playbook\naction: disable-firewalld.yml\npostHook:\n- actionType: playbook\naction: kubeconfig.yml\n- actionType: playbook\naction: cluster-info.yml\n</code></pre>"},{"location":"concepts/crds/#_4","title":"\u914d\u7f6e\u9879","text":""},{"location":"concepts/crds/#_5","title":"\u5143\u6570\u636e","text":"<ul> <li><code>name</code>\uff1aname \u552f\u4e00\u6807\u8bc6\u4e00\u4e2a\u5bf9\u6240\u5173\u8054\u96c6\u7fa4\u7684\u64cd\u4f5c</li> </ul>"},{"location":"concepts/crds/#_6","title":"\u64cd\u4f5c\u5b9a\u4e49","text":"<ul> <li><code>cluster</code>\uff1a\u4e0e\u6b64\u64cd\u4f5c\u5173\u8054\u7684\u96c6\u7fa4\u540d\u79f0\uff0c\u5176\u503c\u4e3a Cluster CRD \u4e2d\u58f0\u660e\u7684\u540d\u79f0</li> <li><code>image</code>\uff1akubespray \u955c\u50cf\u5730\u5740\uff1b\u53ef\u4ee5\u4f7f\u7528 Kubean \u4ed3\u5e93\u6784\u5efa\u7684\u955c\u50cf\uff0c\u4e5f\u53ef\u4f7f\u7528\u81ea\u884c\u6784\u5efa\u955c\u50cf</li> <li><code>actionType</code>\uff1a\u64cd\u4f5c\u7c7b\u578b\uff0c\u76ee\u524d\u652f\u6301\u6307\u5b9a <code>playbook</code> \u6216 <code>shell</code></li> <li><code>action</code>\uff1a\u610f\u56fe\u6267\u884c\u7684\u64cd\u4f5c\uff0c\u76ee\u524d\u652f\u6301\u6307\u5b9a playbook \u6587\u4ef6\u7684\u8def\u5f84\u6216 shell \u547d\u4ee4</li> <li><code>preHook</code>\uff1a\u524d\u7f6e\u6267\u884c\u64cd\u4f5c\uff0c\u53ef\u4ee5\u6307\u5b9a\u591a\u4e2a\uff0c\u4f8b\u5982\u53ef\u4ee5\u6d4b\u8bd5\u8282\u70b9\u8fde\u901a\u6027\u7b49</li> <li><code>actionType</code>\uff1a\u540c\u4e0a</li> <li><code>action</code>\uff1a\u540c\u4e0a</li> <li><code>postHook</code>\uff1a\u540e\u7f6e\u6267\u884c\u64cd\u4f5c\uff0c\u53ef\u4ee5\u6307\u5b9a\u591a\u4e2a\uff0c\u4f8b\u5982\u53ef\u4ee5\u83b7\u53d6\u96c6\u7fa4\u72b6\u6001\u7b49</li> <li><code>actionType</code>\uff1a\u540c\u4e0a</li> <li><code>action</code>\uff1a\u540c\u4e0a</li> <li><code>backoffLimit</code>\uff1a\u64cd\u4f5c\u6267\u884c\u5931\u8d25\u540e\u91cd\u8bd5\u6b21\u6570</li> </ul>"},{"location":"concepts/crds/#manifest","title":"Manifest","text":"<p>Kubean \u5141\u8bb8\u901a\u8fc7 custom resource definitions (CRDs) \u6765\u8bb0\u5f55\u548c\u7ef4\u62a4\u5f53\u524d\u7248\u672c\u7684 Kubean \u4f7f\u7528\u548c\u517c\u5bb9\u7684\u7ec4\u4ef6\u3001\u5305\u53ca\u7248\u672c\uff1b\u4f7f\u7528\u8005\u4e0d\u7528\u624b\u52a8\u7f16\u5199\u6b64\u8d44\u6e90\uff0c\u7531 Kubean \u81ea\u884c\u7ef4\u62a4\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4efd\u793a\u4f8b\uff0c\u5e2e\u52a9\u7406\u89e3\u4e0b\u6587\u7684 spec \u8bf4\u660e\uff1a</p> <pre><code>apiVersion: kubean.io/v1alpha1\nkind: Manifest\nmetadata:\nname: kubeaninfomanifest-v0-4-0-rc2\nspec:\ncomponents:\n- defaultVersion: v1.1.1\nname: cni\nversionRange:\n- v1.0.1\n- v1.1.1\n- defaultVersion: 1.6.9\nname: containerd\nversionRange:\n.......\n- 1.6.7\n- 1.6.8\n- 1.6.9\n- defaultVersion: \"\"\nname: kube\nversionRange:\n- v1.25.3\n- v1.25.2\n- v1.25.1\n........\n- defaultVersion: v3.23.3\nname: calico\nversionRange:\n- v3.23.3\n- v3.22.4\n- v3.21.6\n- defaultVersion: v1.12.1\nname: cilium\nversionRange: []\n- defaultVersion: \"null\"\nname: etcd\nversionRange:\n- v3.5.3\n- v3.5.4\n- v3.5.5\ndocker:\n- defaultVersion: \"20.10\"\nos: redhat-7\nversionRange:\n- latest\n- \"18.09\"\n- \"19.03\"\n- \"20.10\"\n- stable\n- edge\n- defaultVersion: \"20.10\"\nos: debian\nversionRange:\n- latest\n- \"18.09\"\n- \"19.03\"\n- \"20.10\"\n- stable\n- edge\n- defaultVersion: \"20.10\"\nos: ubuntu\nversionRange:\n- latest\n- \"18.09\"\n- \"19.03\"\n- \"20.10\"\n- stable\n- edge\nkubeanVersion: v0.4.0-rc2\nkubesprayVersion: c788620\n</code></pre>"},{"location":"concepts/crds/#spec","title":"spec \u8bf4\u660e","text":"<ul> <li><code>components</code>\uff1a\u955c\u50cf\u6216\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u7248\u672c\u58f0\u660e</li> <li><code>name</code>\uff1a\u7ec4\u4ef6\u540d\u79f0</li> <li><code>defaultVersion</code>\uff1a\u4f7f\u7528\u7684\u9ed8\u8ba4\u7248\u672c</li> <li><code>versionRange</code>\uff1a\u53d7\u652f\u6301\u7684\u7248\u672c\u5217\u8868</li> <li><code>docker</code>\uff1aDocker \u7684\u7248\u672c\u7ba1\u7406</li> <li><code>os</code>\uff1a\u53d7\u652f\u6301\u7684\u64cd\u4f5c\u7cfb\u7edf</li> <li><code>defaultVersion</code>\uff1a\u4f7f\u7528\u7684\u9ed8\u8ba4\u7248\u672c</li> <li><code>versionRange</code>\uff1a\u53d7\u652f\u6301\u7684\u7248\u672c\u5217\u8868</li> <li><code>kubeanVersion</code>\uff1aKubean \u7248\u672c\u53f7</li> <li><code>kubesprayVersion</code>\uff1a\u5f53\u524d Kubean \u4f9d\u8d56\u7684 Kubespray \u7248\u672c\u53f7</li> </ul>"},{"location":"concepts/crds/#localartifact","title":"LocalArtifact","text":"<p>Kubean \u5141\u8bb8\u901a\u8fc7 custom resource definitions (CRDs) \u6765\u8bb0\u5f55\u79bb\u7ebf\u5305\u652f\u6301\u7684\u7ec4\u4ef6\u53ca\u7248\u672c\u4fe1\u606f\uff1b\u4f7f\u7528\u8005\u4e0d\u7528\u624b\u52a8\u7f16\u5199\u6b64\u8d44\u6e90\uff0c\u7531 Kubean \u81ea\u884c\u7ef4\u62a4\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4efd\u793a\u4f8b\uff0c\u5e2e\u52a9\u7406\u89e3\u4e0b\u6587\u7684 spec \u8bf4\u660e\uff1a</p> <pre><code>apiVersion: kubean.io/v1alpha1\nkind: LocalArtifactSet\nmetadata:\nname: offlineversion-20221101\nspec:\narch: [\"x86_64\"]\nkubespray: \"c788620\"\ndocker:\n- os: \"redhat-7\"\nversionRange:\n- \"18.09\"\n- \"19.03\"\n- \"20.10\"\n- os: \"debian\"\nversionRange: []\n- os: \"ubuntu\"\nversionRange: []\nitems:\n- name: \"cni\"\nversionRange:\n- v1.1.1\n- name: \"containerd\"\nversionRange:\n- 1.6.9\n- name: \"kube\"\nversionRange:\n- v1.24.7\n- name: \"calico\"\nversionRange:\n- v3.23.3\n- name: \"cilium\"\nversionRange:\n- v1.12.1\n- name: \"etcd\"\nversionRange:\n- v3.5.4\n</code></pre>"},{"location":"concepts/crds/#spec_1","title":"spec \u8bf4\u660e","text":"<ul> <li><code>arch</code>\uff1a\u53d7\u652f\u6301\u7684 CPU \u6307\u4ee4\u96c6\u67b6\u6784\u5217\u8868</li> <li><code>kubespray</code>\uff1a\u4f7f\u7528\u7684 Kubespray \u7248\u672c</li> <li><code>docker</code>\uff1aDocker \u7248\u672c\u7ba1\u7406</li> <li><code>os</code>\uff1aDocker \u53d7\u652f\u6301\u7684\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b</li> <li><code>versionRange</code>\uff1a\u53d7\u652f\u6301\u7684 Docker \u7248\u672c\u5217\u8868</li> <li><code>items</code>\uff1a\u5176\u4ed6\u7ec4\u4ef6\u7248\u672c\u7ba1\u7406</li> <li><code>name</code>\uff1a\u7ec4\u4ef6\u540d\u79f0</li> <li><code>versionRange</code>\uff1a\u8be5\u7ec4\u4ef6\u53d7\u652f\u6301\u7684\u7248\u672c\u5217\u8868</li> </ul>"},{"location":"concepts/custom_action/","title":"\u81ea\u5b9a\u4e49 Action","text":""},{"location":"concepts/custom_action/#_1","title":"\u52a8\u673a","text":"<p>\u5bf9\u4e8e\u4f7f\u7528\u8005\u6765\u8bb2\uff0cKubean \u548c Kubesprary \u7684\u4ea7\u7269\u90fd\u662f OCI \u955c\u50cf\u3001 helm chart \u53ca K8s manifests\u3002\u5728\u5df2\u62ff\u5230\u8fd9\u4e9b\u4ea7\u7269\u7684\u60c5\u51b5\u4e0b\u8981\u81ea\u5b9a\u4e49\u4e00\u4e9b\u64cd\u4f5c\uff0c\u4e5f\u80fd\u505a\u5230\uff0c\u4f46\u662f\u4f1a\u6bd4\u8f83\u590d\u6742\uff0c\u9700\u8981\u624b\u52a8\u4fee\u6539\u4e0d\u5c11\u7684\u914d\u7f6e\u3002\u5e0c\u671b\u80fd\u591f\u7b80\u5316\u8fd9\u4e00\u8fc7\u7a0b\u3002</p>"},{"location":"concepts/custom_action/#_2","title":"\u76ee\u6807","text":"<p>\u63d0\u4f9b\u4e00\u79cd\u4fbf\u6377\u7684\u65b9\u5f0f\u80fd\u591f\u8ba9\u4f7f\u7528\u8005\u4f7f\u7528\u4e00\u4e9b\u81ea\u5b9a\u4e49\u7684\u64cd\u4f5c\u6765\u67e5\u770b\u3001\u4fee\u6539\u548c\u63a7\u5236\u96c6\u7fa4\u8282\u70b9\u7684\u72b6\u6001\u3002</p>"},{"location":"concepts/custom_action/#crd","title":"CRD \u8bbe\u8ba1","text":"<ol> <li>\u589e\u52a0 ActionSource \u5b57\u6bb5\u4ee5\u58f0\u660e Action \u6765\u6e90\uff0c\u5176\u503c\u76ee\u524d\u652f\u6301\uff1a</li> <li> <p>builtin\uff08\u7f3a\u7701\u503c\uff09 </p> <p>\u8868\u660e\u4f7f\u7528 kubean \u5185\u5efa ansible playbook \u6216\u5728 manifest \u5185\u8054\u7684 shell \u811a\u672c</p> </li> <li> <p>configmap</p> <p>\u8868\u660e\u9700\u8981\u7684 ansible playbook \u6216 shell \u811a\u672c\u901a\u8fc7 \u5f15\u7528 K8s configmap \u6765\u83b7\u53d6</p> </li> <li> <p>\u589e\u52a0 ActionSourceRef \u5b57\u6bb5\u4ee5\u58f0\u660e\u5f53 ActionSource \u503c\u4e3a configmap \u65f6\u6240\u5f15\u7528\u7684\u8d44\u6e90\u5bf9\u8c61\uff0c\u4e14\u4ec5\u5f53 ActionSource \u4e3a configmap \u65f6\u6b64\u5b57\u6bb5\u624d\u751f\u6548\uff0c\u5176\u683c\u5f0f\u4e3a\uff1a     <pre><code>actionSourceRef:\nname: &lt;configmap name&gt;\nnamespace: &lt;namespace of configmap&gt;\n</code></pre></p> </li> </ol> <p>\u914d\u7f6e\u793a\u4f8b\uff1a <pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\nname: cluster1-demo-myaction\nnamespace: kubean-system\ndata:\nmyplaybook.yml: |\n- hosts: k8s_cluster\ngather_facts: false\nbecome: yes\nany_errors_fatal: \"{{ any_errors_fatal | default(true) }}\"\ntasks:\n- name: Print inventory hostname\ndebug:\nmsg: \"inventory_hostname is {{ inventory_hostname }}\"\nhello.sh: |\necho \"hello world!\"\n---\napiVersion: kubean.io/v1alpha1\nkind: ClusterOperation\nmetadata:\nname: cluster1-demo-ops-1\nspec:\ncluster: cluster1-demo\nimage: ghcr.io/kubean-io/spray-job:latest\nbackoffLimit: 0\nactionType: playbook\naction: myplaybook.yml\nactionSource: configmap\nactionSourceRef:\nname: cluster1-demo-myaction\nnamespace: kubean-system\npreHook:\n- actionType: shell\naction: hello.sh\nactionSource: configmap\nactionSourceRef:\nname: cluster1-demo-myaction\nnamespace: kubean-system\n</code></pre></p>"},{"location":"concepts/theory_of_airgapped_package/","title":"\u79bb\u7ebf\u5b89\u88c5\u5305\u7684\u539f\u7406","text":"<p>Kubean CI \u6784\u5efa\u4fbf\u4e8e\u5728\u79bb\u7ebf\u73af\u5883\u4e2d\u5b89\u88c5 Kubernetes \u7684\u79bb\u7ebf\u6587\u4ef6\u3002</p> <p>\u6ce8\uff1a\u6709\u5173\u5982\u4f55\u4f7f\u7528\u79bb\u7ebf\u6587\u4ef6\uff0c\u8bf7\u53c2\u9605\u79bb\u7ebf\u573a\u666f\u7684\u4f7f\u7528\u3002</p> <p>\u672c\u9875\u8bf4\u660e\u79bb\u7ebf\u6587\u4ef6\u5305\u7684\u6784\u5efa\u539f\u7406\u3002</p> <ul> <li>\u53d1\u7248\u9875\u9762\uff1aGithub Releases</li> <li>\u4e3b\u8981\u5305\u542b\uff1a</li> </ul> \u6587\u4ef6\u5305 \u63cf\u8ff0 files-*.tar.gz Kubespray \u5b89\u88c5\u6240\u9700\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff1akubeadm\u3001runc images-*.tar.gz K8s \u96c6\u7fa4\u955c\u50cf\u548c CNI \u955c\u50cf os-pkgs-${linux_distribution}-${tag}.tar.gz K8s \u5b89\u88c5\u671f\u95f4\u6240\u9700\u7684 deb/rpm"},{"location":"concepts/theory_of_airgapped_package/#_2","title":"\u5982\u4f55\u6784\u5efa\u79bb\u7ebf\u6587\u4ef6","text":"<ol> <li>\u955c\u50cf\u548c\u4e8c\u8fdb\u5236\u6587\u4ef6</li> </ol> <p>\u7c7b\u4f3c Kubespray \u79bb\u7ebf\u90e8\u7f72\u6307\u5357\u6240\u8ff0\uff0c    Kubespray \u63d0\u4f9b\u4e86\u4e00\u4e9b\u811a\u672c\u6765\u751f\u6210\u955c\u50cf\u548c\u4e8c\u8fdb\u5236\u6587\u4ef6\u5217\u8868\uff08\u611f\u8c22 Kubespray\uff01\uff09</p> <p>\u5f97\u76ca\u4e8e Kubespray \u751f\u6210\u4e8c\u8fdb\u5236\u548c\u955c\u50cf\u5217\u8868\u7684\u811a\u672c\uff0c    \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 manage-offline-files.sh    \u4e0b\u8f7d\u8fd9\u4e9b\u4e8c\u8fdb\u5236\u6587\u4ef6\u548c\u955c\u50cf\u3002    \u968f\u540e Kubean \u63d0\u4f9b\u4e86 offline-build.sh    \u5c06\u6240\u6709\u8fd9\u4e9b\u878d\u5408\u4e8e\u4e00\u8d77\u3002</p> <ol> <li>os-packages (deb/rpm)</li> </ol> <p>\u5728 K8s \u5b89\u88c5\u671f\u95f4\uff0c\u6709\u4e9b\u6587\u4ef6\u5305\u4e0d\u4f1a\u968f\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e00\u8d77\u5b89\u88c5\uff0c\u56e0\u6b64\u6211\u4eec\u5fc5\u987b\u901a\u8fc7 deb/rpm \u6765\u5b89\u88c5\u8fd9\u4e9b\u6587\u4ef6\u5305\u3002    os packages \u5217\u8868\u5b9a\u4e49\u4e86\u6240\u6d89\u53ca\u7684\u6587\u4ef6\u5305\u3002</p> <p>Github Action \u5c06\u901a\u8fc7 <code>dnf/apt</code> \u6784\u5efa\u4e0d\u540c\u64cd\u4f5c\u7cfb\u7edf\u7684\u6587\u4ef6\u5305\uff08\u4f8b\u5982 Qemu\uff09\uff0c\u4fbf\u4e8e\u4e0b\u8f7d\u548c\u5f52\u6863 RPM/DEB \u5305\u3002</p> <ol> <li>CI \u6d41\u7a0b</li> </ol> <p>\u79bb\u7ebf\u6587\u4ef6\u5305\u7531 Github Action \u811a\u672c\u751f\u6210\u548c\u7ba1\u7406\u3002</p>"},{"location":"develop/roadmap/","title":"Kubean \u8def\u7ebf\u56fe","text":"<p>\u5f53\u524d\u7684 Roadmap \u662f\u6682\u65f6\u7684\uff0c\u5177\u4f53\u7684\u65f6\u95f4\u8868\u4ee5\u793e\u533a\u9700\u8981\u800c\u5b9a\u3002</p> <p>\u5728 Roadmap \u4e2d\u672a\u63d0\u53ca\u7684\u529f\u80fd\u7279\u6027, \u6211\u4eec\u53ef\u4ee5\u5728 issues \u4e2d\u8ba8\u8bba.</p>"},{"location":"develop/roadmap/#q3-2022","title":"Q3 2022","text":"<ul> <li>Kubean \u9879\u76ee\u67b6\u6784\u6d41\u7a0b\u8bbe\u8ba1 architecture.md</li> <li>\u9a8c\u8bc1 Kubean \u7684\u96c6\u7fa4\u751f\u547d\u5468\u671f\u7ba1\u7406\u64cd\u4f5c</li> <li>\u6dfb\u52a0\u7cfb\u7edf\u5305\u6784\u5efa CI https://github.com/kubean-io/kubean/pull/62</li> <li>\u63d0\u4f9b Kubean API https://github.com/kubean-io/kubean/pull/128</li> </ul>"},{"location":"develop/roadmap/#q4-2022","title":"Q4 2022","text":"<ul> <li>E2E tests kubean test case</li> <li>k8s \u955c\u50cf\u53ca\u4e8c\u8fdb\u5236\u5305\u652f\u6301 arm \u67b6\u6784 https://github.com/kubean-io/kubean/pull/200</li> <li>\u652f\u6301\u5347\u7ea7\u5305\u6784\u5efa https://github.com/kubean-io/kubean/pull/289</li> <li>\u79bb\u7ebf\u573a\u666f RHEL8.4 \u90e8\u7f72\u9002\u914d https://github.com/kubean-io/kubean/pull/325</li> <li>\u652f\u6301\u8fd8\u539f\u7cfb\u7edf\u5305\u7ba1\u7406\u914d\u7f6e https://github.com/kubean-io/kubean/pull/298</li> <li>\u652f\u6301\u96c6\u7fa4\u90e8\u7f72\u5b8c\u540e\u56de\u4f20 Kubeconfig https://github.com/kubean-io/kubean/pull/192</li> <li>\u589e\u52a0 SSH Key \u8ba4\u8bc1\u90e8\u7f72\u65b9\u5f0f https://github.com/kubean-io/kubean/pull/302</li> </ul>"},{"location":"develop/roadmap/#q1-2023","title":"Q1 2023","text":"<ul> <li>\u652f\u6301 apt \u7cfb\u7edf\u5305\u7ba1\u7406\u914d\u7f6e https://github.com/kubean-io/kubean/pull/459</li> <li>Cluster Operation CRD \u652f\u6301\u81ea\u5b9a\u4e49 Action https://github.com/kubean-io/kubean/issues/361</li> <li>Kubean Chart \u652f\u6301 Charts Syncer https://github.com/kubean-io/kubean/pull/468</li> <li>\u652f\u6301 Pre check \u90e8\u7f72\u524d\u7684\u9884\u68c0\u6d4b https://github.com/kubean-io/kubean/pull/555</li> <li>\u7edf\u4fe1 UOS 1020a \u7cfb\u7edf\u5305\u9002\u914d https://github.com/kubean-io/kubean/pull/583</li> </ul>"},{"location":"develop/roadmap/#q2-2023","title":"Q2 2023","text":"<ul> <li>\u652f\u6301\u57fa\u4e8e OpenEuler \u7684\u96c6\u7fa4\u90e8\u7f72 https://github.com/kubean-io/kubean/pull/628</li> <li>\u652f\u6301 Other Linux \u4e0d\u540c\u5305\u7ba1\u7406\u5668\u4e0b\u7cfb\u7edf\u5305\u6784\u5efa</li> <li>E2E CI \u4f18\u5316</li> <li>\u4e3a release \u4e2d\u8f93\u51fa\u7684\u5236\u54c1 (Assets) \u589e\u52a0 checksum \u6587\u4ef6</li> <li>\u901a\u8fc7 Join \u5f02\u6784\u8282\u70b9\uff0c\u652f\u6301\u6df7\u5408\u67b6\u6784\u90e8\u7f72</li> </ul>"},{"location":"releases/v0.4.0/","title":"V0.4.0","text":""},{"location":"releases/v0.4.0/#whats-changed","title":"What's Changed","text":"<ul> <li>update docker os-pkg version by @hangscer8 in https://github.com/kubean-io/kubean/pull/262</li> <li>cluster info with more retry time by @hangscer8 in https://github.com/kubean-io/kubean/pull/261</li> <li>Manifest crd support multi image repo by @hangscer8 in https://github.com/kubean-io/kubean/pull/266</li> <li>update kubespray default version to v1.24.7 by @ErikJiang in https://github.com/kubean-io/kubean/pull/272</li> <li>Disable cn proxy sources to improve kubean image build efficiency by @ErikJiang in https://github.com/kubean-io/kubean/pull/273</li> <li>fix e2e by @wenting-guo in https://github.com/kubean-io/kubean/pull/267</li> <li>add dasu23 into approvers by @YunShiHang in https://github.com/kubean-io/kubean/pull/275</li> <li>Update offline doc by @ErikJiang in https://github.com/kubean-io/kubean/pull/276</li> <li>Fix temporary version tag issues by @YunShiHang in https://github.com/kubean-io/kubean/pull/281</li> <li>add version constraints of dependencies in offline case by @tu1h in https://github.com/kubean-io/kubean/pull/274</li> <li>[chroe] Improve the install trivy method by @SSmallMonster in https://github.com/kubean-io/kubean/pull/282</li> <li>add certificated logo by @wenting-guo in https://github.com/kubean-io/kubean/pull/284</li> <li>adjust generate_offline_package to multi harbor projects by @hangscer8 in https://github.com/kubean-io/kubean/pull/285</li> <li>Unified k8s version by @ErikJiang in https://github.com/kubean-io/kubean/pull/286</li> <li>Update README badge by @ErikJiang in https://github.com/kubean-io/kubean/pull/287</li> <li>Add Dockerfile for airgap-patch by @hangscer8 in https://github.com/kubean-io/kubean/pull/289</li> <li>Add os package for ubuntu by @ErikJiang in https://github.com/kubean-io/kubean/pull/291</li> <li>rename ansible_ssh_pass to ansible_password by @tu1h in https://github.com/kubean-io/kubean/pull/290</li> <li>rename doc folder to docs by @tu1h in https://github.com/kubean-io/kubean/pull/293</li> <li>Add Doc For Airgap Patch by @hangscer8 in https://github.com/kubean-io/kubean/pull/294</li> <li>fix pr e2e fail by @wenting-guo in https://github.com/kubean-io/kubean/pull/288</li> <li>Support restore yum repo in enable-repo.yml by @ErikJiang in https://github.com/kubean-io/kubean/pull/298</li> <li>update &amp; add some docs by @tu1h in https://github.com/kubean-io/kubean/pull/299</li> <li>Add documentation for deploying clusters with ssh secret keys by @ErikJiang in https://github.com/kubean-io/kubean/pull/302</li> <li>Update doc for deploy cluster with ssh key by @ErikJiang in https://github.com/kubean-io/kubean/pull/306</li> <li>Add auto release notes ci by @YunShiHang in https://github.com/kubean-io/kubean/pull/309</li> <li>add os compatibility e2e by @wenting-guo in https://github.com/kubean-io/kubean/pull/310</li> <li>fix checkout repository bug by @YunShiHang in https://github.com/kubean-io/kubean/pull/311</li> <li>add unit test by @hangscer8 in https://github.com/kubean-io/kubean/pull/314</li> <li>chore: add ut by @yyzxw in https://github.com/kubean-io/kubean/pull/313</li> <li>fix airgap patch mod by @hangscer8 in https://github.com/kubean-io/kubean/pull/315</li> <li>import_iso support kylin v10 sp2 by @hangscer8 in https://github.com/kubean-io/kubean/pull/316</li> <li>Translation of kubean documents (issue305) by @yulng in https://github.com/kubean-io/kubean/pull/307</li> <li>upgrade kind version to 1.25.3 by @wenting-guo in https://github.com/kubean-io/kubean/pull/312</li> <li>[CI]add incremental packages by @YunShiHang in https://github.com/kubean-io/kubean/pull/317</li> <li>Update os_family for kylin in enable-repo playbook by @ErikJiang in https://github.com/kubean-io/kubean/pull/318</li> <li>Add os packages for kylin linux by @ErikJiang in https://github.com/kubean-io/kubean/pull/321</li> <li>Update os packages for kylin linux by @ErikJiang in https://github.com/kubean-io/kubean/pull/324</li> <li>Update the absolute path of the command in playbook by @ErikJiang in https://github.com/kubean-io/kubean/pull/326</li> <li>Offline adapation for RHEL 8.4 by @tu1h in https://github.com/kubean-io/kubean/pull/325</li> <li>fix Dockerfile.redhat8 by @tu1h in https://github.com/kubean-io/kubean/pull/327</li> <li>v0.4.1 Pre-release version by @ErikJiang in https://github.com/kubean-io/kubean/pull/329</li> </ul>"},{"location":"releases/v0.4.0/#new-contributors","title":"New Contributors","text":"<ul> <li>@tu1h made their first contribution in https://github.com/kubean-io/kubean/pull/274</li> <li>@SSmallMonster made their first contribution in https://github.com/kubean-io/kubean/pull/282</li> <li>@yulng made their first contribution in https://github.com/kubean-io/kubean/pull/307</li> </ul> <p>Full Changelog: https://github.com/kubean-io/kubean/compare/v0.3.7...v0.4.0</p>"},{"location":"releases/v0.4.1/","title":"V0.4.1","text":""},{"location":"releases/v0.4.1/#whats-changed","title":"What's Changed","text":"<ul> <li>Fix import_iso.sh by @tu1h in https://github.com/kubean-io/kubean/pull/330</li> <li>specify k8s version by @ErikJiang in https://github.com/kubean-io/kubean/pull/331</li> <li>Fix kylin linux offline deployment python3-libselinux dependency issue by @ErikJiang in https://github.com/kubean-io/kubean/pull/332</li> <li>translate sshkey_deploy_cluster.md by @Michelle951 in https://github.com/kubean-io/kubean/pull/323</li> <li>translate comparisons.md by @Michelle951 in https://github.com/kubean-io/kubean/pull/322</li> <li>translate crds.md to en by @Michelle951 in https://github.com/kubean-io/kubean/pull/320</li> <li>update packages.yml for kylin os by @ErikJiang in https://github.com/kubean-io/kubean/pull/335</li> <li>fix test by @hangscer8 in https://github.com/kubean-io/kubean/pull/334</li> <li>add release-process.md by @hangscer8 in https://github.com/kubean-io/kubean/pull/333</li> <li>Fix released image tag overrided by @tu1h in https://github.com/kubean-io/kubean/pull/336</li> <li>add offline-e2e by @wenting-guo in https://github.com/kubean-io/kubean/pull/341</li> <li>fix offline e2e workflow file by @wenting-guo in https://github.com/kubean-io/kubean/pull/342</li> <li>chart: namespace should go with release by @weizhoublue in https://github.com/kubean-io/kubean/pull/337</li> <li>update case md by @wenting-guo in https://github.com/kubean-io/kubean/pull/343</li> <li>Fix template rendering failure by @tu1h in https://github.com/kubean-io/kubean/pull/338</li> <li>fix offline workflow by @wenting-guo in https://github.com/kubean-io/kubean/pull/344</li> <li>fix offline shell by @wenting-guo in https://github.com/kubean-io/kubean/pull/345</li> <li>update airgap_patch image tag in doc by @hangscer8 in https://github.com/kubean-io/kubean/pull/349</li> <li>oprimize offline shell by @wenting-guo in https://github.com/kubean-io/kubean/pull/369</li> <li>optimize logs output by @hangscer8 in https://github.com/kubean-io/kubean/pull/362</li> <li>Optimize kubeanoperation spec.image tag by @hangscer8 in https://github.com/kubean-io/kubean/pull/371</li> <li>shihang.yun-fix-cd-bug by @YunShiHang in https://github.com/kubean-io/kubean/pull/374</li> <li>shihang.yun-optimize-input by @YunShiHang in https://github.com/kubean-io/kubean/pull/375</li> <li>fix cd image tag's bug by @YunShiHang in https://github.com/kubean-io/kubean/pull/376</li> <li>use kube-vip first by @hangscer8 in https://github.com/kubean-io/kubean/pull/379</li> <li>fix kubeconfig playbook by @hangscer8 in https://github.com/kubean-io/kubean/pull/380</li> <li>Reduce kubespray image size by @tu1h in https://github.com/kubean-io/kubean/pull/382</li> <li>allow custom kubean image repo in cd by @tu1h in https://github.com/kubean-io/kubean/pull/372</li> <li>fix arm image build failure by @tu1h in https://github.com/kubean-io/kubean/pull/384</li> <li>fix airgap-patch image build failure by @tu1h in https://github.com/kubean-io/kubean/pull/385</li> <li>Remove libselinux from os packages by @ErikJiang in https://github.com/kubean-io/kubean/pull/386</li> <li>Fix local Service yum repo by @hangscer8 in https://github.com/kubean-io/kubean/pull/387</li> <li>optimize offline-e2e environment set by @wenting-guo in https://github.com/kubean-io/kubean/pull/389</li> <li>add rhel7 ospkg by @tu1h in https://github.com/kubean-io/kubean/pull/390</li> <li>Check if the OS package needs to be rebuilt by @ErikJiang in https://github.com/kubean-io/kubean/pull/391</li> <li>Update get latest tag by @ErikJiang in https://github.com/kubean-io/kubean/pull/393</li> <li>Ready for release version v0.4.1 by @ErikJiang in https://github.com/kubean-io/kubean/pull/394</li> </ul>"},{"location":"releases/v0.4.1/#new-contributors","title":"New Contributors","text":"<ul> <li>@Michelle951 made their first contribution in https://github.com/kubean-io/kubean/pull/323</li> <li>@weizhoublue made their first contribution in https://github.com/kubean-io/kubean/pull/337</li> </ul> <p>Full Changelog: https://github.com/kubean-io/kubean/compare/v0.4.0...v0.4.1</p>"},{"location":"releases/v0.4.10/","title":"V0.4.10","text":""},{"location":"releases/v0.4.10/#whats-changed","title":"What's Changed","text":"<ul> <li>update redaht8 related e2e case by @wenting-guo in https://github.com/kubean-io/kubean/pull/654</li> <li>fix: ignore actionSourceRef not set by @jonyhy96 in https://github.com/kubean-io/kubean/pull/666</li> <li>optimize generate crds by @hangscer8 in https://github.com/kubean-io/kubean/pull/667</li> <li>add UT by @hangscer8 in https://github.com/kubean-io/kubean/pull/670</li> <li>kubean install on none kubean-system ns e2e by @wenting-guo in https://github.com/kubean-io/kubean/pull/672</li> <li>fix speedup offline package by @wenting-guo in https://github.com/kubean-io/kubean/pull/676</li> <li>[docs] update and translate theory-of-air-gapped-package.md by @windsonsea in https://github.com/kubean-io/kubean/pull/671</li> <li>cleanup: replace pkg ioutil with os by @yyzxw in https://github.com/kubean-io/kubean/pull/680</li> <li>update e2e case md by @wenting-guo in https://github.com/kubean-io/kubean/pull/683</li> <li>fix create job occasionally unsuccessfully  from ops by @hangscer8 in https://github.com/kubean-io/kubean/pull/684</li> <li>Fix ansible lint by @tu1h in https://github.com/kubean-io/kubean/pull/694</li> <li>Add kubean examples by @ErikJiang in https://github.com/kubean-io/kubean/pull/693</li> </ul> <p>Full Changelog: https://github.com/kubean-io/kubean/compare/v0.4.9...v0.4.10</p>"},{"location":"releases/v0.4.2/","title":"V0.4.2","text":""},{"location":"releases/v0.4.2/#whats-changed","title":"What's Changed","text":"<ul> <li>Update previous tag by @ErikJiang in https://github.com/kubean-io/kubean/pull/395</li> <li>remove preset playbook by @tu1h in https://github.com/kubean-io/kubean/pull/396</li> <li>fix enable-repo by @hangscer8 in https://github.com/kubean-io/kubean/pull/397</li> <li>Block the update repo from kylin os by @ErikJiang in https://github.com/kubean-io/kubean/pull/399</li> <li>Revert \"fix enable-repo\" by @hangscer8 in https://github.com/kubean-io/kubean/pull/400</li> <li>Remove unnecessary pkgs by @tu1h in https://github.com/kubean-io/kubean/pull/403</li> <li>Improve check_rebuild_pkgs by @tu1h in https://github.com/kubean-io/kubean/pull/404</li> <li>Restore os pkg by @tu1h in https://github.com/kubean-io/kubean/pull/411</li> <li>Revert \"Restore os pkg\" by @ErikJiang in https://github.com/kubean-io/kubean/pull/412</li> <li>Restore os pkg by @tu1h in https://github.com/kubean-io/kubean/pull/413</li> <li>add kylin os case by @wenting-guo in https://github.com/kubean-io/kubean/pull/416</li> <li>fix offline e2e bug by @wenting-guo in https://github.com/kubean-io/kubean/pull/417</li> <li>update pr ci yaml by @wenting-guo in https://github.com/kubean-io/kubean/pull/422</li> <li>make pr ci from vagrant to vm by @wenting-guo in https://github.com/kubean-io/kubean/pull/423</li> <li>add a parameter to pr ci workflow by @wenting-guo in https://github.com/kubean-io/kubean/pull/435</li> <li>add calico case in nightly e2e by @wenting-guo in https://github.com/kubean-io/kubean/pull/438</li> <li>add secrets for nightly e2e in workflow yaml by @wenting-guo in https://github.com/kubean-io/kubean/pull/445</li> <li>Add resources by @ErikJiang in https://github.com/kubean-io/kubean/pull/447</li> <li>update case md by @wenting-guo in https://github.com/kubean-io/kubean/pull/448</li> <li>update nightly e2e yaml by @wenting-guo in https://github.com/kubean-io/kubean/pull/449</li> <li>update kubean logo by @ErikJiang in https://github.com/kubean-io/kubean/pull/450</li> <li>update os compatibility e2e to vm by @wenting-guo in https://github.com/kubean-io/kubean/pull/451</li> <li>update nightly e2e passwd to secret by @wenting-guo in https://github.com/kubean-io/kubean/pull/455</li> <li>add secrets parameter in os compatibility workflow yaml by @wenting-guo in https://github.com/kubean-io/kubean/pull/456</li> <li>Remove versions.json by @tu1h in https://github.com/kubean-io/kubean/pull/452</li> <li>optimize hardcode namespace by @hangscer8 in https://github.com/kubean-io/kubean/pull/457</li> <li>Support import for ubuntu iso by @tu1h in https://github.com/kubean-io/kubean/pull/458</li> <li>Add spray job timeout by @hangscer8 in https://github.com/kubean-io/kubean/pull/462</li> <li>Remove fuse only in docker mode by @tu1h in https://github.com/kubean-io/kubean/pull/463</li> <li>add apt repo in enable-repo playbook by @ErikJiang in https://github.com/kubean-io/kubean/pull/459</li> <li>Update the check scripts for building os packages by @ErikJiang in https://github.com/kubean-io/kubean/pull/464</li> <li>fix  nightly e2e helm version set by @wenting-guo in https://github.com/kubean-io/kubean/pull/466</li> <li>support charts syncer by @ErikJiang in https://github.com/kubean-io/kubean/pull/468</li> <li>update restore apt condition in enable-repo playbook by @ErikJiang in https://github.com/kubean-io/kubean/pull/471</li> <li>Update action version for workflows by @ErikJiang in https://github.com/kubean-io/kubean/pull/474</li> <li>add redhat offline e2e by @wenting-guo in https://github.com/kubean-io/kubean/pull/475</li> <li>update case md by @wenting-guo in https://github.com/kubean-io/kubean/pull/476</li> <li>add unit test by @hangscer8 in https://github.com/kubean-io/kubean/pull/478</li> <li>set runner2 ip for e2e by @wenting-guo in https://github.com/kubean-io/kubean/pull/485</li> <li>update e2e k8s version to 1.24.7 by @wenting-guo in https://github.com/kubean-io/kubean/pull/489</li> <li>set nightly e2e and online os-compatibility-e2e to the online runner by @wenting-guo in https://github.com/kubean-io/kubean/pull/491</li> <li>Add ansible-lint for playbooks in pr gate by @tu1h in https://github.com/kubean-io/kubean/pull/483</li> <li>Support import offline resource parallelly by @tu1h in https://github.com/kubean-io/kubean/pull/482</li> <li>Fix job creating failure across different namespace by @tu1h in https://github.com/kubean-io/kubean/pull/488</li> <li>change upgrade e2e to vm by @wenting-guo in https://github.com/kubean-io/kubean/pull/492</li> <li>fix sa error by @cleverhu in https://github.com/kubean-io/kubean/pull/493</li> <li>change cluster lcm e2e case to vm by @wenting-guo in https://github.com/kubean-io/kubean/pull/497</li> <li>Get serviceaccount name by labelselector by @tu1h in https://github.com/kubean-io/kubean/pull/499</li> <li>add calico dual stack e2e by @wenting-guo in https://github.com/kubean-io/kubean/pull/500</li> <li>update online os compatibility run rate by @wenting-guo in https://github.com/kubean-io/kubean/pull/501</li> <li>support imageRepo with password by @hangscer8 in https://github.com/kubean-io/kubean/pull/502</li> <li>optimize ClusterRole &amp;&amp; set COMMIT_SHA for release by @hangscer8 in https://github.com/kubean-io/kubean/pull/506</li> <li>set kubespray commit by @hangscer8 in https://github.com/kubean-io/kubean/pull/507</li> </ul> <p>Full Changelog: https://github.com/kubean-io/kubean/compare/v0.4.1...v0.4.2</p>"},{"location":"releases/v0.4.3/","title":"V0.4.3","text":""},{"location":"releases/v0.4.3/#whats-changed","title":"What's Changed","text":"<ul> <li>rollback clusterrole by @hangscer8 in https://github.com/kubean-io/kubean/pull/511</li> <li>update minio repo by @wenting-guo in https://github.com/kubean-io/kubean/pull/512</li> <li>Fix incomplete ospkg cache judgment by @tu1h in https://github.com/kubean-io/kubean/pull/513</li> </ul> <p>Full Changelog: https://github.com/kubean-io/kubean/compare/v0.4.2...v0.4.3</p>"},{"location":"releases/v0.4.4/","title":"V0.4.4","text":""},{"location":"releases/v0.4.4/#whats-changed","title":"What's Changed","text":"<ul> <li>Remove ospkg buiding immediate exit by @tu1h in https://github.com/kubean-io/kubean/pull/514</li> <li>Fix import ospkgs script by @tu1h in https://github.com/kubean-io/kubean/pull/515</li> <li>Remove audit on rhel8 by @tu1h in https://github.com/kubean-io/kubean/pull/517</li> <li>add kubean maintainer by @wawa0210 in https://github.com/kubean-io/kubean/pull/519</li> <li>fix release image by @ErikJiang in https://github.com/kubean-io/kubean/pull/520</li> </ul>"},{"location":"releases/v0.4.4/#new-contributors","title":"New Contributors","text":"<ul> <li>@wawa0210 made their first contribution in https://github.com/kubean-io/kubean/pull/519</li> </ul> <p>Full Changelog: https://github.com/kubean-io/kubean/compare/v0.4.3...v0.4.4</p>"},{"location":"releases/v0.4.5/","title":"V0.4.5","text":""},{"location":"releases/v0.4.5/#whats-changed","title":"What's Changed","text":"<ul> <li>fix typo hack script for setup by @yanggangtony in https://github.com/kubean-io/kubean/pull/516</li> <li>chore: delete unused file #523 by @yyzxw in https://github.com/kubean-io/kubean/pull/526</li> <li>Fix offline e2e failure by @XiuguangHuang in https://github.com/kubean-io/kubean/pull/530</li> <li>Remove runc on offline rhel8 from playbook by @tu1h in https://github.com/kubean-io/kubean/pull/531</li> <li>fix imageRepo field by @panguicai008 in https://github.com/kubean-io/kubean/pull/534</li> <li>Update e2e_schedule.yaml by @XiuguangHuang in https://github.com/kubean-io/kubean/pull/536</li> <li>fix variable definition by @panguicai008 in https://github.com/kubean-io/kubean/pull/533</li> <li>fix spray-job container name by @hangscer8 in https://github.com/kubean-io/kubean/pull/537</li> <li>fix cluster status.conditions.startTime and endTime invalid value null by @panguicai008 in https://github.com/kubean-io/kubean/pull/538</li> <li>fix clusteroperation multi field invalid value null by @panguicai008 in https://github.com/kubean-io/kubean/pull/539</li> <li>Support custom action by @tu1h in https://github.com/kubean-io/kubean/pull/540</li> <li>Reduce centos7 package size by @yankay in https://github.com/kubean-io/kubean/pull/543</li> <li>Update CD about helm cmd vars by @tu1h in https://github.com/kubean-io/kubean/pull/546</li> <li>provide auto ci of k8s version compatibility by @XiuguangHuang in https://github.com/kubean-io/kubean/pull/547</li> <li>Support upgrade kubean CRDs by helm by @tu1h in https://github.com/kubean-io/kubean/pull/552</li> <li>Fix charts rendering exception by @tu1h in https://github.com/kubean-io/kubean/pull/554</li> <li>support pre-check playbook by @hangscer8 in https://github.com/kubean-io/kubean/pull/555</li> <li>Fix incorrect rendered template by @tu1h in https://github.com/kubean-io/kubean/pull/556</li> <li>optimize pre-check playbook by @hangscer8 in https://github.com/kubean-io/kubean/pull/559</li> <li>add ut by @hangscer8 in https://github.com/kubean-io/kubean/pull/560</li> <li>Set offline-pkg default k8s version to 1.25.4 by @hangscer8 in https://github.com/kubean-io/kubean/pull/564</li> <li>Add Others OS package build method by @ErikJiang in https://github.com/kubean-io/kubean/pull/561</li> <li>fix offline e2e and update iptables e2e test by @XiuguangHuang in https://github.com/kubean-io/kubean/pull/557</li> <li>fix main branch: auto-kubean-compatibility-schedule.yaml was modified incorrectly  by @XiuguangHuang in https://github.com/kubean-io/kubean/pull/563</li> <li>fix the wrong image tag when the main ci builds images. by @XiuguangHuang in https://github.com/kubean-io/kubean/pull/558</li> <li>Fix image name when push, and update the default k8s version to 1.26.0, fix kube_version of offline e2e  by @XiuguangHuang in https://github.com/kubean-io/kubean/pull/566</li> <li>add unit-test by @hangscer8 in https://github.com/kubean-io/kubean/pull/568</li> <li>support import iso for uniontech by @ErikJiang in https://github.com/kubean-io/kubean/pull/570</li> <li>add node affinity for chart by @ErikJiang in https://github.com/kubean-io/kubean/pull/571</li> <li>fix airgap patch image build and push by @XiuguangHuang in https://github.com/kubean-io/kubean/pull/572</li> <li>support unionTech for enable repo playbook by @ErikJiang in https://github.com/kubean-io/kubean/pull/575</li> <li>update anti affinity for kubean by @ErikJiang in https://github.com/kubean-io/kubean/pull/579</li> <li>set helm upgrade timeout and sprayJob tag by @XiuguangHuang in https://github.com/kubean-io/kubean/pull/578</li> <li>fix: update offline usage docs by @yyzxw in https://github.com/kubean-io/kubean/pull/577</li> <li>add theory-of-air-gapped-package by @panpan0000 in https://github.com/kubean-io/kubean/pull/582</li> <li>Update build script for UOS by @ErikJiang in https://github.com/kubean-io/kubean/pull/583</li> <li>optimize airgap patch by @hangscer8 in https://github.com/kubean-io/kubean/pull/584</li> <li>fix mv no such file in RHEL by @ErikJiang in https://github.com/kubean-io/kubean/pull/586</li> <li>optimize airgap patch image by @hangscer8 in https://github.com/kubean-io/kubean/pull/588</li> <li>change runner1 e2e ips by @XiuguangHuang in https://github.com/kubean-io/kubean/pull/589</li> <li>fix wrong tag of cd when running main ci by @XiuguangHuang in https://github.com/kubean-io/kubean/pull/581</li> <li>add call-cd params in main ci and release ci by @XiuguangHuang in https://github.com/kubean-io/kubean/pull/591</li> <li>add extra binary for airgap-patch by @hangscer8 in https://github.com/kubean-io/kubean/pull/592</li> <li>add create cilium cluster e2e test by @XiuguangHuang in https://github.com/kubean-io/kubean/pull/594</li> <li>remove registry.k8s.io/pause:3.4 by @hangscer8 in https://github.com/kubean-io/kubean/pull/595</li> </ul>"},{"location":"releases/v0.4.5/#new-contributors","title":"New Contributors","text":"<ul> <li>@XiuguangHuang made their first contribution in https://github.com/kubean-io/kubean/pull/530</li> <li>@panguicai008 made their first contribution in https://github.com/kubean-io/kubean/pull/534</li> <li>@panpan0000 made their first contribution in https://github.com/kubean-io/kubean/pull/582</li> </ul> <p>Full Changelog: https://github.com/kubean-io/kubean/compare/v0.4.4...v0.4.5</p>"},{"location":"releases/v0.4.6/","title":"V0.4.6","text":""},{"location":"releases/v0.4.6/#whats-changed","title":"What's Changed","text":"<ul> <li>clean unnecessary files by @hangscer8 in https://github.com/kubean-io/kubean/pull/597</li> <li>add debugger2 vms and debug cilium cluster by @wenting-guo in https://github.com/kubean-io/kubean/pull/598</li> <li>delete unused test case doc by @XiuguangHuang in https://github.com/kubean-io/kubean/pull/599</li> <li>Precheck Result Configmap by @hangscer8 in https://github.com/kubean-io/kubean/pull/600</li> <li>fix upgrade failed due to hard affinity by @ErikJiang in https://github.com/kubean-io/kubean/pull/601</li> <li>add cilium_kube_proxy_replacement by @XiuguangHuang in https://github.com/kubean-io/kubean/pull/605</li> <li>download offline files after release ci by @XiuguangHuang in https://github.com/kubean-io/kubean/pull/607</li> </ul> <p>Full Changelog: https://github.com/kubean-io/kubean/compare/v0.4.5...v0.4.6</p>"},{"location":"releases/v0.4.7/","title":"V0.4.7","text":""},{"location":"releases/v0.4.7/#whats-changed","title":"What's Changed","text":"<ul> <li>Fix incorrect data type on ActionSource by @tu1h in https://github.com/kubean-io/kubean/pull/613</li> </ul> <p>Full Changelog: https://github.com/kubean-io/kubean/compare/v0.4.6...v0.4.7</p>"},{"location":"releases/v0.4.8/","title":"V0.4.8","text":""},{"location":"releases/v0.4.8/#whats-changed","title":"What's Changed","text":"<ul> <li>add multi kubean operator e2e case by @XiuguangHuang in https://github.com/kubean-io/kubean/pull/608</li> <li>Update changes imported by pointer type by @tu1h in https://github.com/kubean-io/kubean/pull/618</li> </ul> <p>Full Changelog: https://github.com/kubean-io/kubean/compare/v0.4.7...v0.4.8</p>"},{"location":"releases/v0.4.9/","title":"V0.4.9","text":""},{"location":"releases/v0.4.9/#whats-changed","title":"What's Changed","text":"<ul> <li>fix download files job by @XiuguangHuang in https://github.com/kubean-io/kubean/pull/620</li> <li>fix remount iso by @hangscer8 in https://github.com/kubean-io/kubean/pull/624</li> <li>adding flannel\u3001kube-ovn to manifest cr by @cyclinder in https://github.com/kubean-io/kubean/pull/622</li> <li>[docs] add readme_zh.md by @windsonsea in https://github.com/kubean-io/kubean/pull/623</li> <li>Add code-of-conduct and CONTRIBUTING documentation by @tu1h in https://github.com/kubean-io/kubean/pull/625</li> <li>remove redundant docker os_pkgs by @hangscer8 in https://github.com/kubean-io/kubean/pull/626</li> <li>support openEuler by @hangscer8 in https://github.com/kubean-io/kubean/pull/628</li> <li>optimize import iso openeuler by @hangscer8 in https://github.com/kubean-io/kubean/pull/629</li> <li>support other linux in AirGap scenario by @ErikJiang in https://github.com/kubean-io/kubean/pull/627</li> <li>update pkgs.yml by @ErikJiang in https://github.com/kubean-io/kubean/pull/630</li> <li>fix unkonwn arch image by @ErikJiang in https://github.com/kubean-io/kubean/pull/631</li> <li>add openeuler ospkg by @hangscer8 in https://github.com/kubean-io/kubean/pull/632</li> <li>Support import ISO data to local path by @tu1h in https://github.com/kubean-io/kubean/pull/640</li> <li>Add Dependabot by @ErikJiang in https://github.com/kubean-io/kubean/pull/641</li> <li>Bump mikefarah/yq from 4.30.8 to 4.33.3 by @dependabot in https://github.com/kubean-io/kubean/pull/645</li> <li>Bump docker/build-push-action from 3.3.0 to 4.0.0 by @dependabot in https://github.com/kubean-io/kubean/pull/642</li> <li>Fix import_iso.sh by @tu1h in https://github.com/kubean-io/kubean/pull/651</li> <li>Bump docker/setup-buildx-action from 2.2.1 to 2.5.0 by @dependabot in https://github.com/kubean-io/kubean/pull/644</li> <li>Bump actions/setup-go from 3 to 4 by @dependabot in https://github.com/kubean-io/kubean/pull/643</li> <li>set pr-ci nightly-ci run time-limit to 15h by @wenting-guo in https://github.com/kubean-io/kubean/pull/653</li> <li>include dockerfile on ospkg cache judgment include by @tu1h in https://github.com/kubean-io/kubean/pull/655</li> <li>doc: fix english doc broken link by @jonyhy96 in https://github.com/kubean-io/kubean/pull/656</li> <li>add speedup offline packages by @wenting-guo in https://github.com/kubean-io/kubean/pull/657</li> <li>Add Roadmap by @ErikJiang in https://github.com/kubean-io/kubean/pull/661</li> <li>generate offline package for flannel by @cyclinder in https://github.com/kubean-io/kubean/pull/662</li> <li>add unsafe_show_logs to debug the download failed resource by @wenting-guo in https://github.com/kubean-io/kubean/pull/663</li> </ul>"},{"location":"releases/v0.4.9/#new-contributors","title":"New Contributors","text":"<ul> <li>@cyclinder made their first contribution in https://github.com/kubean-io/kubean/pull/622</li> <li>@dependabot made their first contribution in https://github.com/kubean-io/kubean/pull/645</li> <li>@jonyhy96 made their first contribution in https://github.com/kubean-io/kubean/pull/656</li> </ul> <p>Full Changelog: https://github.com/kubean-io/kubean/compare/v0.4.8...v0.4.9</p>"},{"location":"releases/v0.5.0/","title":"V0.5.0","text":""},{"location":"releases/v0.5.0/#whats-changed","title":"What's Changed","text":"<ul> <li>support oracle linux in offline enviroment by @ErikJiang in https://github.com/kubean-io/kubean/pull/700</li> </ul> <p>Full Changelog: https://github.com/kubean-io/kubean/compare/v0.4.10...v0.5.0</p>"},{"location":"releases/v0.5.1/","title":"V0.5.1","text":""},{"location":"releases/v0.5.1/#whats-changed","title":"What's Changed","text":"<ul> <li>remove dockerCE from openeuler pkgs by @hangscer8 in https://github.com/kubean-io/kubean/pull/706</li> <li>kubean e2e ci follow kubespray structure category by @tukwila in https://github.com/kubean-io/kubean/pull/707</li> <li>Fix KUBEAN_E2E_TEST_CI Error: A branch or tag with the name kubean_ci_test could not be found by @tukwila in https://github.com/kubean-io/kubean/pull/709</li> <li>fix kubean e2e ci not really run problem by @tukwila in https://github.com/kubean-io/kubean/pull/712</li> <li>Rename subdir api mod path by @hangscer8 in https://github.com/kubean-io/kubean/pull/715</li> <li>update other linux tool script by @ErikJiang in https://github.com/kubean-io/kubean/pull/716</li> <li>fix ci config variables by @tukwila in https://github.com/kubean-io/kubean/pull/718</li> <li>Update go mod dep version by @hangscer8 in https://github.com/kubean-io/kubean/pull/719</li> <li>add ipvs case by @wenting-guo in https://github.com/kubean-io/kubean/pull/714</li> <li>enable trivy security scanning by @hangscer8 in https://github.com/kubean-io/kubean/pull/721</li> <li>update enable repo playbook by @ErikJiang in https://github.com/kubean-io/kubean/pull/723</li> <li>add clean repolist in other linux script by @ErikJiang in https://github.com/kubean-io/kubean/pull/725</li> <li>update yum repo config in other linux by @ErikJiang in https://github.com/kubean-io/kubean/pull/726</li> <li>add mkdocs by @ErikJiang in https://github.com/kubean-io/kubean/pull/728</li> <li>update docs by @ErikJiang in https://github.com/kubean-io/kubean/pull/729</li> </ul> <p>Full Changelog: https://github.com/kubean-io/kubean/compare/v0.5.0...v0.5.1</p>"},{"location":"releases/v0.5.2-rc1/","title":"V0.5.2 rc1","text":""},{"location":"releases/v0.5.2-rc1/#whats-changed","title":"What's Changed","text":"<ul> <li>add module repo for yum manager by @ErikJiang in https://github.com/kubean-io/kubean/pull/730</li> </ul> <p>Full Changelog: https://github.com/kubean-io/kubean/compare/v0.5.1...v0.5.2-rc1</p>"},{"location":"releases/v0.5.2/","title":"V0.5.2","text":""},{"location":"releases/v0.5.2/#whats-changed","title":"What's Changed","text":"<ul> <li>add module repo for yum manager by @ErikJiang in https://github.com/kubean-io/kubean/pull/730</li> <li>CI failure:debug vm change to runner vm  by @yulng in https://github.com/kubean-io/kubean/pull/734</li> <li>update kube download url by @ErikJiang in https://github.com/kubean-io/kubean/pull/735</li> </ul> <p>Full Changelog: https://github.com/kubean-io/kubean/compare/v0.5.1...v0.5.2</p>"},{"location":"releases/v0.5.3/","title":"V0.5.3","text":""},{"location":"releases/v0.5.3/#whats-changed","title":"What's Changed","text":"<ul> <li>CI failure :change vm config and update docker rm command by @yulng in https://github.com/kubean-io/kubean/pull/740</li> <li>fetch os kernel version in precheck.yml by @hangscer8 in https://github.com/kubean-io/kubean/pull/739</li> <li>add ut by @hangscer8 in https://github.com/kubean-io/kubean/pull/741</li> <li>add kubean compatibility k8s version 1.27.1 by @wenting-guo in https://github.com/kubean-io/kubean/pull/743</li> <li>Update allinone.md by @yanrongshi in https://github.com/kubean-io/kubean/pull/749</li> <li>Support script import_iso.sh to load main function by @ErikJiang in https://github.com/kubean-io/kubean/pull/753</li> <li>Update README.md by @wawa0210 in https://github.com/kubean-io/kubean/pull/754</li> <li>add readme for docs by @ErikJiang in https://github.com/kubean-io/kubean/pull/755</li> <li>ignore pull pause 4 image by @ErikJiang in https://github.com/kubean-io/kubean/pull/756</li> </ul>"},{"location":"releases/v0.5.3/#new-contributors","title":"New Contributors","text":"<ul> <li>@yanrongshi made their first contribution in https://github.com/kubean-io/kubean/pull/749</li> </ul> <p>Full Changelog: https://github.com/kubean-io/kubean/compare/v0.5.2...v0.5.3</p>"},{"location":"releases/v0.5.4/","title":"V0.5.4","text":""},{"location":"releases/v0.5.4/#whats-changed","title":"What's Changed","text":"<ul> <li>remove alpha_arm by @hangscer8 in https://github.com/kubean-io/kubean/pull/759</li> <li>centos_cilium_online should use offline runner by @tukwila in https://github.com/kubean-io/kubean/pull/761</li> <li>e2e:update worker cluster k8s version by @yulng in https://github.com/kubean-io/kubean/pull/760</li> <li>update import iso by @ErikJiang in https://github.com/kubean-io/kubean/pull/762</li> </ul> <p>Full Changelog: https://github.com/kubean-io/kubean/compare/v0.5.3...v0.5.4</p>"},{"location":"usage/airgap/","title":"\u79bb\u7ebf\u573a\u666f\u7684\u4f7f\u7528","text":""},{"location":"usage/airgap/#_2","title":"\u63d0\u9192\u4e8b\u9879","text":"<ul> <li>\u9488\u5bf9 RHEL 8.4 \u7cfb\u5217\uff0c\u7531\u4e8e\u5305\u4f9d\u8d56\u95ee\u9898\uff0c\u6267\u884c\u8fc7\u7a0b\u4e2d\u4f1a\u5378\u8f7d\u7cfb\u7edf\u9884\u88c5\u7684 fuse \u5305</li> </ul>"},{"location":"usage/airgap/#_3","title":"\u51c6\u5907\u4e8b\u9879","text":"<ol> <li> <p>\u9700\u8981\u9884\u5148\u90e8\u7f72\u7684\u670d\u52a1:</p> <ul> <li>\u6587\u4ef6\u8d44\u6e90\u670d\u52a1 <code>minio</code></li> <li>\u955c\u50cf\u4ed3\u5e93\u670d\u52a1 <code>docker registry</code>\uff082.7 \u4ee5\u4e0b\uff09\u6216\u8005 <code>harbor</code></li> </ul> </li> <li> <p>\u9700\u8981\u5b89\u88c5\u7684\u5fc5\u8981\u5de5\u5177:</p> <ul> <li>\u7528\u4e8e\u5bfc\u5165\u955c\u50cf\u6587\u4ef6\u7684\u5de5\u5177: <code>skopeo</code>\uff0c\u9700\u8981 &gt;=1.9.2</li> <li>\u7528\u4e8e\u5bfc\u5165\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u5de5\u5177: <code>minio client</code></li> </ul> </li> <li> <p>\u901a\u8fc7Helm\u90e8\u7f72<code>kubean</code></p> </li> </ol>"},{"location":"usage/airgap/#_4","title":"\u4e0b\u8f7d\u79bb\u7ebf\u8d44\u6e90","text":"<p>\u901a\u8fc7 Github Releases \u9875\u9762\u53ef\u4ee5\u4e0b\u8f7d\u6211\u4eec\u60f3\u8981\u7248\u672c\u7684\u79bb\u7ebf\u8d44\u6e90\u3002</p> <p>\u79bb\u7ebf\u8d44\u6e90\u7684\u57fa\u672c\u8bf4\u660e:</p> <pre><code>\u251c\u2500\u2500 files.list                                  # \u6587\u4ef6\u5185\u5bb9\u7684\u5217\u8868\n\u251c\u2500\u2500 files-${tag}.tar.gz                         # \u6587\u4ef6\u538b\u7f29\u5305, \u5185\u542b\u5bfc\u5165\u811a\u672c\n\u251c\u2500\u2500 images.list                                 # \u955c\u50cf\u5185\u5bb9\u7684\u5217\u8868\n\u251c\u2500\u2500 images-${tag}.tar.gz                        # \u955c\u50cf\u538b\u7f29\u5305, \u5185\u542b\u5bfc\u5165\u811a\u672c\n\u2514\u2500\u2500 os-pkgs-${linux_distribution}-${tag}.tar.gz # \u5404\u7cfb\u7edf\u538b\u7f29\u5305, \u5185\u542b\u5bfc\u5165\u811a\u672c\n</code></pre>"},{"location":"usage/airgap/#_5","title":"\u5c06\u79bb\u7ebf\u8d44\u6e90\u5bfc\u5165\u5bf9\u5e94\u670d\u52a1","text":""},{"location":"usage/airgap/#1-binaries","title":"1. Binaries \u8d44\u6e90\u7684\u5bfc\u5165","text":"<p>\u8bf7\u5148\u89e3\u538b <code>files-${tag}.tar.gz</code> \u6587\u4ef6, \u5176\u5185\u90e8\u5305\u542b:</p> <pre><code>files/\n\u251c\u2500\u2500 import_files.sh       # \u8be5\u811a\u672c\u7528\u4e8e\u5bfc\u5165\u4e8c\u8fdb\u5236\u6587\u4ef6\u5230 minio \u6587\u4ef6\u670d\u52a1\n\u2514\u2500\u2500 offline-files.tar.gz  # \u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u538b\u7f29\u5305\n</code></pre> <p>\u6267\u884c\u5982\u4e0b\u547d\u4ee4, \u5c06\u4e8c\u8fdb\u5236\u6587\u4ef6\u5bfc\u5165\u5230 minio \u670d\u52a1\u4e2d:</p> <pre><code>$ MINIO_USER=${username} MINIO_PASS=${password} ./import_files.sh ${minio_address}\n</code></pre> <ul> <li><code>minio_address</code> \u662f <code>minio API Server</code>\u5730\u5740\uff0c\u7aef\u53e3\u4e00\u822c\u4e3a9000\uff0c\u6bd4\u5982 <code>http://1.2.3.4:9000</code></li> </ul>"},{"location":"usage/airgap/#2-images","title":"2. Images \u8d44\u6e90\u7684\u5bfc\u5165","text":"<p>\u9700\u8981\u89e3\u538b <code>images-${tag}.tar.gz</code> \u6587\u4ef6, \u5176\u5185\u90e8\u5305\u542b:</p> <pre><code>images/\n\u251c\u2500\u2500 import_images.sh       # \u8be5\u811a\u672c\u7528\u4e8e\u5bfc\u5165\u955c\u50cf\u6587\u4ef6\u5230 docker registry \u6216 harbor \u955c\u50cf\u4ed3\u5e93\u670d\u52a1\n\u2514\u2500\u2500 offline-images.tar.gz  # \u955c\u50cf\u6587\u4ef6\u7684\u538b\u7f29\u5305\n</code></pre> <p>\u6267\u884c\u5982\u4e0b\u547d\u4ee4, \u5c06\u955c\u50cf\u6587\u4ef6\u5bfc\u5165\u5230 docker registry \u6216 harbor \u955c\u50cf\u4ed3\u5e93\u670d\u52a1\u4e2d:</p> <pre><code># 1. \u975e\u5b89\u5168\u514d\u5bc6\u6a21\u5f0f\n$ DEST_TLS_VERIFY=false ./import_images.sh ${registry_address}\n\n# 2. \u7528\u6237\u540d\u53e3\u4ee4\u6a21\u5f0f\n$ DEST_USER=${username} DEST_PASS=${password} ./import_images.sh ${registry_address}\n</code></pre> <ul> <li>\u5f53 <code>DEST_TLS_VERIFY=false</code>, \u6b64\u65f6\u91c7\u7528\u975e\u5b89\u5168 HTTP \u6a21\u5f0f\u4e0a\u4f20\u955c\u50cf</li> <li>\u5f53\u955c\u50cf\u4ed3\u5e93\u5b58\u5728\u7528\u6237\u540d\u5bc6\u7801\u9a8c\u8bc1\u65f6\uff0c\u9700\u8981\u8bbe\u7f6e <code>DEST_USER</code> \u548c <code>DEST_PASS</code></li> <li><code>registry_address</code> \u662f\u955c\u50cf\u4ed3\u5e93\u7684\u5730\u5740\uff0c\u6bd4\u5982<code>1.2.3.4:5000</code></li> </ul>"},{"location":"usage/airgap/#3-os-packages","title":"3. OS packages \u8d44\u6e90\u7684\u5bfc\u5165","text":"<p>\u6ce8\u610f:  - \u76ee\u524d\u652f\u6301 Centos / Redhat / Kylin / Ubuntu \u7b49\u53d1\u884c\u7248\u7684 OS Packages \u8d44\u6e90 - \u7edf\u4fe1 UnionTech V20 \u7cfb\u5217\u7684 OS Package \u9700\u8981\u624b\u52a8\u6784\u5efa\uff0c\u6784\u5efa\u65b9\u6cd5\u89c1 README</p> <p>\u9700\u8981\u89e3\u538b <code>os-pkgs-${linux_distribution}-${tag}.tar.gz</code> \u6587\u4ef6, \u5176\u5185\u90e8\u5305\u542b:</p> <pre><code>os-pkgs\n\u251c\u2500\u2500 import_ospkgs.sh              # \u8be5\u811a\u672c\u7528\u4e8e\u5bfc\u5165 os packages \u5230 minio \u6587\u4ef6\u670d\u52a1\n\u251c\u2500\u2500 os-pkgs-amd64.tar.gz   # amd64 \u67b6\u6784\u7684 os packages \u5305\n\u251c\u2500\u2500 os-pkgs-arm64.tar.gz   # arm64 \u67b6\u6784\u7684 os packages \u5305\n\u2514\u2500\u2500 os-pkgs.sha256sum.txt  # os packages \u5305\u7684 sha256sum \u6548\u9a8c\u6587\u4ef6\n</code></pre> <p>\u6267\u884c\u5982\u4e0b\u547d\u4ee4, \u5c06 os packages \u5305\u5230 minio \u6587\u4ef6\u670d\u52a1\u4e2d:</p> <pre><code>$ MINIO_USER=${username} MINIO_PASS=${password} ./import_ospkgs.sh ${minio_address} os-pkgs-${arch}.tar.gz\n</code></pre>"},{"location":"usage/airgap/#_6","title":"\u5efa\u7acb\u79bb\u7ebf\u6e90","text":"<p>\u4e0b\u9762\u7684\u3010\u5efa\u7acb\u672c\u5730ISO\u955c\u50cf\u6e90\u3011\u4e0e\u3010\u5efa\u7acb\u5728\u7ebfISO\u955c\u50cf\u6e90\u3011\u53ea\u9700\u8981\u6267\u884c\u5176\u4e2d\u4e00\u4e2a\u5373\u53ef\u3002</p>"},{"location":"usage/airgap/#1-iso","title":"1. \u5efa\u7acbISO\u955c\u50cf\u6e90","text":""},{"location":"usage/airgap/#11-iso","title":"1.1 \u5efa\u7acb\u672c\u5730 ISO \u955c\u50cf\u6e90","text":"<p>OS Packages \u4e3b\u8981\u7528\u4e8e\u89e3\u51b3 docker-ce \u7684\u5b89\u88c5\u4f9d\u8d56, \u4f46\u5728\u5b9e\u9645\u7684\u79bb\u7ebf\u90e8\u7f72\u8fc7\u7a0b\u4e2d, \u53ef\u80fd\u8fd8\u9700\u8981\u4f7f\u7528\u5230\u53d1\u884c\u7248\u7cfb\u7edf\u7684\u5176\u4ed6\u5305, \u6b64\u65f6\u9700\u8981\u5efa\u7acb\u672c\u5730 ISO \u955c\u50cf\u6e90.</p> <p>\u6ce8: \u6211\u4eec\u9700\u8981\u63d0\u524d\u4e0b\u8f7d\u4e3b\u673a\u5bf9\u5e94\u7684 ISO \u7cfb\u7edf\u53d1\u884c\u7248\u955c\u50cf, \u5f53\u524d\u652f\u6301 Centos\u3001Redhat\u3001Ubuntu \u53d1\u884c\u7248\u7684 ISO \u955c\u50cf\u6e90\u521b\u5efa; \u6ce8\uff1a\u9700\u8981\u5728\u6bcf\u4e2a\u521b\u5efakubernetes\u7684\u96c6\u7fa4\u4e0a\u90fd\u6267\u884c\u672c\u64cd\u4f5c;</p> <p>\u8fd9\u91cc\u53ef\u4ee5\u4f7f\u7528\u811a\u672c <code>artifacts/gen_repo_conf.sh</code>, \u6267\u884c\u5982\u4e0b\u547d\u4ee4\u5373\u53ef\u6302\u8f7d ISO \u955c\u50cf\u6587\u4ef6, \u5e76\u521b\u5efa Repo \u914d\u7f6e\u6587\u4ef6:</p> <pre><code># \u57fa\u672c\u683c\u5f0f\n$ ./gen_repo_conf.sh --iso-mode ${linux_distribution} ${iso_image_file}\n\n# \u6267\u884c\u811a\u672c\u521b\u5efa ISO \u955c\u50cf\u6e90\n$ ./gen_repo_conf.sh --iso-mode centos CentOS-7-x86_64-Everything-2207-02.iso\n# \u67e5\u770b ISO \u955c\u50cf\u6302\u8f7d\u60c5\u51b5\n$ df -h | grep mnt\n/dev/loop0               9.6G  9.6G     0 100% /mnt/centos-iso\n# \u67e5\u770b ISO \u955c\u50cf\u6e90\u914d\u7f6e\n$ cat /etc/yum.repos.d/Kubean-ISO.repo\n[kubean-iso]\nname=Kubean ISO Repo\nbaseurl=file:///mnt/centos-iso\nenabled=1\ngpgcheck=0\nsslverify=0\n</code></pre>"},{"location":"usage/airgap/#12-iso","title":"1.2 \u5efa\u7acb\u5728\u7ebf ISO \u955c\u50cf\u6e90","text":""},{"location":"usage/airgap/#minio","title":"\u5bfc\u5165\u81f3Minio","text":"<p>\u5c06 ISO \u4e2d\u7684\u955c\u50cf\u6e90\u5bfc\u5165\u5230minio server\u4e2d\uff0c\u9700\u8981\u4f7f\u7528\u5230\u811a\u672c <code>artifacts/import_iso.sh</code> \uff0c\u6267\u884c\u5982\u4e0b\u9762\u547d\u4ee4\u5373\u53ef\u5c06 ISO \u955c\u50cf\u4e2d\u8f6f\u4ef6\u6e90\u5bfc\u5165\u5230 minio server \u4e2d</p> <pre><code>MINIO_USER=${username} MINIO_PASS=${password} ./import_iso.sh ${minio_address} Centos-XXXX.ISO\n</code></pre> <p>\u4e3a\u4e3b\u673a\u65b0\u5efa\u5982\u4e0b\u6587\u4ef6 <code>/etc/yum.repos.d/centos-iso-online.repo</code> \u5373\u53ef\u4f7f\u7528\u5728\u7ebf ISO \u955c\u50cf\u6e90:</p> <pre><code>[kubean-iso-online]\nname=Kubean ISO Repo Online\nbaseurl=${minio_address}/kubean/centos-iso/$releasever/os/$basearch\nenabled=1\ngpgcheck=0\nsslverify=0\n</code></pre> <p>\u6b64\u5916\uff0c\u5982\u679c\u5bfc\u5165\u7684\u662f RHEL ISO\uff0c\u9700\u6ce8\u610f\u6b64 ISO \u63d0\u4f9b\u4e24\u4e2a\u6e90\uff1a</p> <pre><code>[kubean-iso-online-BaseOS]\nname=Kubean ISO Repo Online BaseOS\nbaseurl=${minio_address}/kubean/redhat-iso/$releasever/os/$basearch/BaseOS\nenabled=1\ngpgcheck=0\nsslverify=0\n\n\n[kubean-iso-online-AppStream]\nname=Kubean ISO Repo Online AppStream\nbaseurl=${minio_address}/kubean/redhat-iso/$releasever/os/$basearch/AppStream\nenabled=1\ngpgcheck=0\nsslverify=0\n</code></pre> <ul> <li>\u9700\u8981\u5c06 <code>${minio_address}</code> \u66ff\u6362\u4e3a minio API Server \u5730\u5740</li> </ul>"},{"location":"usage/airgap/#_7","title":"\u5bfc\u5165\u81f3\u672c\u5730\u76ee\u5f55","text":"<p>\u5c06 ISO \u4e2d\u7684\u955c\u50cf\u6e90\u5bfc\u5165\u5230\u672c\u5730\u76ee\u5f55\u4e2d\uff0c\u9700\u8981\u4f7f\u7528\u5230\u811a\u672c <code>artifacts/import_iso.sh</code> \uff0c\u6267\u884c\u5982\u4e0b\u9762\u547d\u4ee4\u5373\u53ef\u5c06 ISO \u955c\u50cf\u4e2d\u8f6f\u4ef6\u6e90\u5bfc\u5165\u5230\u6307\u5b9a\u7684\u672c\u5730\u76ee\u5f55\u4e2d</p> <pre><code>./import_iso.sh ${you_local_path} Centos-XXXX.ISO\n</code></pre> <p>repo\u914d\u7f6e\u65b9\u5f0f\u7c7b\u4f3c\u4e0a\u65b9 \u5bfc\u5165\u81f3Minio</p> <pre><code>[kubean-iso-online]\nname=Kubean ISO Repo Online\nbaseurl=${your_local_path}/centos-iso/$releasever/os/$basearch\nenabled=1\ngpgcheck=0\nsslverify=0\n</code></pre>"},{"location":"usage/airgap/#2-extras","title":"2. \u5efa\u7acb extras \u8f6f\u4ef6\u6e90","text":"<p>\u5f53\u524d\u4ec5\u652f\u6301 Centos \u53d1\u884c\u7248</p> <p>\u5728\u5b89\u88c5 K8S \u96c6\u7fa4\u65f6, \u8fd8\u4f1a\u4f9d\u8d56\u4e00\u4e9b extras \u8f6f\u4ef6, \u6bd4\u5982 <code>container-selinux</code>, \u8fd9\u4e9b\u8f6f\u4ef6\u5f80\u5f80\u5728 ISO \u955c\u50cf\u6e90\u4e2d\u5e76\u4e0d\u63d0\u4f9b. \u5bf9\u6b64 OS packages \u79bb\u7ebf\u5305\u5df2\u5bf9\u5176\u8fdb\u884c\u4e86\u8865\u5145, \u5176\u5728\u5bfc\u5165 minio \u4e4b\u540e, \u6211\u4eec\u8fd8\u9700\u8981\u5411\u5404\u4e2a\u8282\u70b9\u521b\u5efa extra repo \u914d\u7f6e\u6587\u4ef6.</p> <p>\u540c\u6837\u53ef\u4ee5\u4f7f\u7528\u811a\u672c <code>artifacts/gen_repo_conf.sh</code>, \u6267\u884c\u5982\u4e0b\u547d\u4ee4\u5373\u53ef\u521b\u5efa Extra Repo:</p> <pre><code>$ ./gen_repo_conf.sh --url-mode ${linux_distribution} ${repo_base_url}\n\n# \u6267\u884c\u811a\u672c\u521b\u5efa URL \u6e90\u914d\u7f6e\u6587\u4ef6\n$ ./gen_repo_conf.sh --url-mode centos ${minio_address}/kubean/centos/\\$releasever/os/\\$basearch\n# \u67e5\u770b URL \u6e90\u914d\u7f6e\u6587\u4ef6\n$ cat /etc/yum.repos.d/Kubean-URL.repo\n[kubean-extra]\nname=Kubean Extra Repo\nbaseurl=http://10.20.30.40:9000/kubean/centos/$releasever/os/$basearch\nenabled=1\ngpgcheck=0\nsslverify=0\n</code></pre> <p>\u6ce8: \u82e5 <code>repo_base_url</code> \u53c2\u6570\u4e2d\u5e26\u6709 <code>$</code> \u7b26\u53f7, \u9700\u8981\u5bf9\u5176\u8fdb\u884c\u8f6c\u4e49 <code>\\$</code></p> <p>\u9700\u8981\u5c06 <code>${minio_address}</code> \u66ff\u6362\u4e3a\u5b9e\u9645 <code>minio API Server</code> \u7684\u5730\u5740</p>"},{"location":"usage/airgap/#3-clusteroperation-playbook","title":"3. ClusterOperation \u7ed3\u5408 playbook \u521b\u5efa\u6e90\u914d\u7f6e\u6587\u4ef6","text":"<p>\u7531\u4e8e\u521b\u5efa\u6e90\u7684\u8fc7\u7a0b\u6d89\u53ca\u5230\u96c6\u7fa4\u7684\u6240\u6709\u8282\u70b9, \u624b\u52a8\u811a\u672c\u64cd\u4f5c\u76f8\u5bf9\u7e41\u7410, \u8fd9\u91cc\u63d0\u4f9b\u4e86\u4e00\u79cd playbook \u7684\u89e3\u51b3\u65b9\u5f0f.</p> <p>centos yum repo \u7684\u914d\u7f6e\u793a\u4f8b\uff1a <pre><code>apiVersion: kubean.io/v1alpha1\nkind: ClusterOperation\nmetadata:\nname: cluster-ops-01\nspec:\ncluster: sample\nimage: ghcr.io/kubean-io/spray-job:latest\nbackoffLimit: 0\nactionType: playbook\naction: cluster.yml\npreHook:\n- actionType: playbook\naction: ping.yml\n- actionType: playbook\naction: enable-repo.yml  # \u5728\u90e8\u7f72\u96c6\u7fa4\u524d, \u5148\u6267\u884c enable-repo \u7684 playbook, \u4e3a\u6bcf\u4e2a\u8282\u70b9\u521b\u5efa\u6307\u5b9a url \u7684\u6e90\u914d\u7f6e\nextraArgs: |\n-e \"{repo_list: ['http://10.20.30.40:9000/kubean/centos/\\$releasever/os/\\$basearch']}\"\n- actionType: playbook\naction: disable-firewalld.yml\npostHook:\n- actionType: playbook\naction: cluster-info.yml\n- actionType: playbook\naction: enable-repo.yml  # \u5728\u90e8\u7f72\u96c6\u7fa4\u540e, \u8fd8\u539f\u5404\u8282\u70b9 yum repo \u914d\u7f6e. (\u6ce8\uff1a\u6b64\u6b65\u9aa4, \u53ef\u89c6\u60c5\u51b5\u6dfb\u52a0.)\nextraArgs: |\n-e undo=true\n</code></pre></p> <p>ubuntu20.04 apt repo \u7684\u914d\u7f6e\u793a\u4f8b\uff1a <pre><code>apiVersion: kubean.io/v1alpha1\nkind: ClusterOperation\nmetadata:\nname: cluster-ops-01\nspec:\ncluster: sample\nimage: ghcr.io/kubean-io/spray-job:latest\nbackoffLimit: 0\nactionType: playbook\naction: cluster.yml\npreHook:\n- actionType: playbook\naction: ping.yml\n- actionType: playbook\naction: enable-repo.yml  # \u5728\u90e8\u7f72\u96c6\u7fa4\u524d, \u5148\u6267\u884c enable-repo \u7684 playbook, \u4e3a\u6bcf\u4e2a\u8282\u70b9\u521b\u5efa\u6307\u5b9a url \u7684\u6e90\u914d\u7f6e [\u6ce8\uff1aubuntu \u662f os package \u79bb\u7ebf\u8d44\u6e90\uff0cubuntu-iso \u662f iso \u5b89\u88c5\u5305\u8d44\u6e90]\nextraArgs: |\n-e \"{repo_list: ['deb [trusted=yes] http://MINIO_ADDR:9000/kubean/ubuntu/amd64 focal/', 'deb [trusted=yes] http://MINIO_ADDR:9000/kubean/ubuntu-iso focal main restricted']}\"\n- actionType: playbook\naction: disable-firewalld.yml\npostHook:\n- actionType: playbook\naction: cluster-info.yml\n- actionType: playbook\naction: enable-repo.yml  # \u5728\u90e8\u7f72\u96c6\u7fa4\u540e, \u8fd8\u539f\u5404\u8282\u70b9 apt repo \u914d\u7f6e. (\u6ce8\uff1a\u6b64\u6b65\u9aa4, \u53ef\u89c6\u60c5\u51b5\u6dfb\u52a0.)\nextraArgs: |\n-e undo=true\n</code></pre></p>"},{"location":"usage/airgap/#_8","title":"\u90e8\u7f72\u96c6\u7fa4\u524d\u7684\u914d\u7f6e","text":"<p>\u79bb\u7ebf\u8bbe\u7f6e\u9700\u8981\u53c2\u8003 <code>kubespray</code> \u4f4d\u4e8e <code>kubespray/inventory/sample/group_vars/all/offline.yml</code> \u7684\u914d\u7f6e\u6587\u4ef6:</p> <pre><code>---\n## \u5168\u5c40\u7684\u79bb\u7ebf\u914d\u7f6e\n### \u914d\u7f6e\u79c1\u6709\u5bb9\u5668\u955c\u50cf\u4ed3\u5e93\u670d\u52a1\u7684\u5730\u5740\nregistry_host: \"{{ registry_address }}\"\n\n### \u914d\u7f6e\u4e8c\u8fdb\u5236\u6587\u4ef6\u670d\u52a1\u7684\u5730\u5740\nfiles_repo: \"{{ minio_address }}/kubean\"\n\n### \u5982\u679c\u4f7f\u7528 CentOS / RedHat / AlmaLinux / Fedora, \u9700\u8981\u914d\u7f6e yum \u6e90\u6587\u4ef6\u670d\u52a1\u5730\u5740:\nyum_repo: \"{{ minio_address }}\"\n\n### \u5982\u679c\u4f7f\u7528 Debian, \u5219\u914d\u7f6e:\ndebian_repo: \"{{ minio_address }}\"\n\n### \u5982\u679c\u4f7f\u7528 Ubuntu, \u5219\u914d\u7f6e:\nubuntu_repo: \"{{ minio_address }}\"\n\n### \u5982\u679c containerd \u91c7\u7528\u975e\u5b89\u5168 HTTP \u514d\u8ba4\u8bc1\u65b9\u5f0f, \u5219\u9700\u8981\u914d\u7f6e:\ncontainerd_insecure_registries:\n\"{{ registry_address }}\": \"http://{{ registry_address }}\"\n\n### \u5982\u679c docker \u91c7\u7528\u975e\u5b89\u5168 HTTP \u514d\u8ba4\u8bc1\u65b9\u5f0f, \u5219\u9700\u8981\u914d\u7f6e:\ndocker_insecure_registries:\n- {{ registry_address }}\n\n## Kubernetes components\nkubeadm_download_url: \"{{ files_repo }}/dl.k8s.io/release/{{ kubeadm_version }}/bin/linux/{{ image_arch }}/kubeadm\"\nkubectl_download_url: \"{{ files_repo }}/dl.k8s.io/release/{{ kube_version }}/bin/linux/{{ image_arch }}/kubectl\"\nkubelet_download_url: \"{{ files_repo }}/dl.k8s.io/release/{{ kube_version }}/bin/linux/{{ image_arch }}/kubelet\"\n\n## CNI Plugins\ncni_download_url: \"{{ files_repo }}/github.com/containernetworking/plugins/releases/download/{{ cni_version }}/cni-plugins-linux-{{ image_arch }}-{{ cni_version }}.tgz\"\n\n## cri-tools\ncrictl_download_url: \"{{ files_repo }}/github.com/kubernetes-sigs/cri-tools/releases/download/{{ crictl_version }}/crictl-{{ crictl_version }}-{{ ansible_system | lower }}-{{ image_arch }}.tar.gz\"\n\n## [Optional] etcd: only if you **DON'T** use etcd_deployment=host\netcd_download_url: \"{{ files_repo }}/github.com/etcd-io/etcd/releases/download/{{ etcd_version }}/etcd-{{ etcd_version }}-linux-{{ image_arch }}.tar.gz\"\n\n# [Optional] Calico: If using Calico network plugin\ncalicoctl_download_url: \"{{ files_repo }}/github.com/projectcalico/calico/releases/download/{{ calico_ctl_version }}/calicoctl-linux-{{ image_arch }}\"\ncalicoctl_alternate_download_url: \"{{ files_repo }}/github.com/projectcalico/calicoctl/releases/download/{{ calico_ctl_version }}/calicoctl-linux-{{ image_arch }}\"\n# [Optional] Calico with kdd: If using Calico network plugin with kdd datastore\ncalico_crds_download_url: \"{{ files_repo }}/github.com/projectcalico/calico/archive/{{ calico_version }}.tar.gz\"\n\n# [Optional] Flannel: If using Falnnel network plugin\nflannel_cni_download_url: \"{{ files_repo }}/kubernetes/flannel/{{ flannel_cni_version }}/flannel-{{ image_arch }}\"\n\n# [Optional] helm: only if you set helm_enabled: true\nhelm_download_url: \"{{ files_repo }}/get.helm.sh/helm-{{ helm_version }}-linux-{{ image_arch }}.tar.gz\"\n\n# [Optional] crun: only if you set crun_enabled: true\ncrun_download_url: \"{{ files_repo }}/github.com/containers/crun/releases/download/{{ crun_version }}/crun-{{ crun_version }}-linux-{{ image_arch }}\"\n\n# [Optional] kata: only if you set kata_containers_enabled: true\nkata_containers_download_url: \"{{ files_repo }}/github.com/kata-containers/kata-containers/releases/download/{{ kata_containers_version }}/kata-static-{{ kata_containers_version }}-{{ ansible_architecture }}.tar.xz\"\n\n# [Optional] cri-dockerd: only if you set container_manager: docker\ncri_dockerd_download_url: \"{{ files_repo }}/github.com/Mirantis/cri-dockerd/releases/download/v{{ cri_dockerd_version }}/cri-dockerd-{{ cri_dockerd_version }}.{{ image_arch }}.tgz\"\n\n# [Optional] runc,containerd: only if you set container_runtime: containerd\nrunc_download_url: \"{{ files_repo }}/github.com/opencontainers/runc/releases/download/{{ runc_version }}/runc.{{ image_arch }}\"\ncontainerd_download_url: \"{{ files_repo }}/github.com/containerd/containerd/releases/download/v{{ containerd_version }}/containerd-{{ containerd_version }}-linux-{{ image_arch }}.tar.gz\"\nnerdctl_download_url: \"{{ files_repo }}/github.com/containerd/nerdctl/releases/download/v{{ nerdctl_version }}/nerdctl-{{ nerdctl_version }}-{{ ansible_system | lower }}-{{ image_arch }}.tar.gz\"\n</code></pre> <p>\u989d\u5916\u8bf4\u660e\uff1a</p> <p>\u9488\u5bf9\u4e00\u4e9b\u7279\u6b8a\u7684\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5728\u79bb\u7ebf\u90e8\u7f72\u65f6\uff0c\u8fd8\u9700\u8981\u6dfb\u52a0\u4e00\u4e9b\u989d\u5916\u53c2\u6570\uff1a</p> \u64cd\u4f5c\u7cfb\u7edf \u989d\u5916\u53c2\u6570 RHEL \u7cfb\u5217 <code>rhel_enable_repos: false</code> Oracle Linux \u7cfb\u5217 <code>use_oracle_public_repo: false</code> <p>\u6211\u4eec\u4ee5 <code>examples/install/3.airgap</code> \u4f5c\u4e3a\u6a21\u677f,</p> <p>\u5c06\u5982\u4e0a\u79bb\u7ebf\u914d\u7f6e\u6309\u7167\u5177\u4f53\u60c5\u51b5\u8fdb\u884c\u8c03\u6574, \u7279\u522b\u9700\u8981\u66ff\u6362<code>&lt;registry_address&gt;</code> \u548c <code>&lt;minio_address&gt;</code>,</p> <p>\u6700\u7ec8\u5c06\u914d\u7f6e\u6dfb\u52a0\u66f4\u65b0\u5230 <code>examples/install/3.airgap/VarsConfCM.yml</code> \u6587\u4ef6\u4e2d,</p> <p>\u540c\u65f6\u6211\u4eec\u8fd8\u9700\u8981\u4fee\u6539 <code>examples/install/3.airgap/HostsConfCM.yml</code> \u4e2d\u7684\u96c6\u7fa4\u8282\u70b9 IP \u53ca\u7528\u6237\u540d\u5bc6\u7801,</p> <p>\u6700\u7ec8, \u901a\u8fc7 <code>kubectl apply -f examples/install/3.airgap</code> \u542f\u52a8 ClusterOperation \u4efb\u52a1\u6765\u5b89\u88c5 k8s \u96c6\u7fa4.</p>"},{"location":"usage/airgap/#_9","title":"\u589e\u91cf\u79bb\u7ebf\u5305\u7684\u751f\u6210\u548c\u4f7f\u7528","text":"<p>\u8be6\u7ec6\u6587\u6863\u89c1: Air gap patch usage\u3002</p>"},{"location":"usage/airgap_patch_usage/","title":"\u589e\u91cf\u79bb\u7ebf\u5305\u7684\u751f\u6210\u548c\u4f7f\u7528","text":"<p>\u4e3a\u4e86\u6ee1\u8db3\u7528\u6237\u5bf9\u4e8e\u67d0\u4e9b\u8f6f\u4ef6\u7279\u5b9a\u7248\u672c\u7684\u9700\u8981\uff0ckubean\u63d0\u4f9b\u811a\u672c <code>artifacts/offline_patch.py</code> \u7528\u6765\u6839\u636e\u914d\u7f6e\u6587\u4ef6 <code>manifest.yml</code> \u6765\u751f\u6210\u5bf9\u5e94\u7248\u672c\u7684\u79bb\u7ebf\u5305\u3002</p>"},{"location":"usage/airgap_patch_usage/#_2","title":"\u751f\u6210\u589e\u91cf\u79bb\u7ebf\u5305","text":"<ol> <li>\u5728\u5f53\u524d\u6587\u4ef6\u5939\u65b0\u5efa <code>manifest.yml</code> \u6587\u4ef6\uff0c\u5185\u5bb9\u4e3e\u4f8b\u5982\u4e0b:</li> </ol> <pre><code>image_arch:\n- \"amd64\"\n- \"arm64\"\nkube_version:\n- \"v1.24.6\"\n- \"v1.24.4\"\ncalico_version:\n- \"v3.23.3\"\ncni_version:\n- \"v1.1.1\"\ncontainerd_version:\n- \"1.6.8\"\ncilium_version:\n- \"v1.12.1\"\netcd_version:\n- \"v3.5.3\"\n</code></pre> <ol> <li> <p>\u5728\u5f53\u524d\u6587\u4ef6\u5939\u65b0\u5efa <code>data</code> \u6587\u4ef6\u5939</p> </li> <li> <p>\u4f7f\u7528\u955c\u50cf\uff0c\u7b49\u5f85\u8fd0\u884c\u9000\u51fa\u540e\uff0c<code>data</code> \u6587\u4ef6\u5939\u4e2d\u751f\u6210\u589e\u91cf\u79bb\u7ebf\u5305</p> </li> </ol> <pre><code>docker run -v $(pwd)/manifest.yml:/manifest.yml -v $(pwd)/data:/data ghcr.io/kubean-io/airgap-patch:v0.4.0-rc5 </code></pre>"},{"location":"usage/airgap_patch_usage/#_3","title":"\u4f7f\u7528\u589e\u91cf\u79bb\u7ebf\u5305","text":"<p>\u589e\u91cf\u5305\u7684\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b:</p> <pre><code>data\n\u2514\u2500\u2500 v_offline_patch\n    \u251c\u2500\u2500 amd64\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 files\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 import_files.sh\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 offline-files.tar.gz\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 images\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 import_images.sh\n    \u2502\u00a0\u00a0     \u2514\u2500\u2500 offline-images.tar.gz\n    \u251c\u2500\u2500 arm64\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 files\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 import_files.sh\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 offline-files.tar.gz\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 images\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 import_images.sh\n    \u2502\u00a0\u00a0     \u2514\u2500\u2500 offline-images.tar.gz\n    \u2514\u2500\u2500 kubeanofflineversion.cr.patch.yaml\n</code></pre> <p>(1). \u5411 MinIO \u4e2d\u5199\u5165\u6587\u4ef6\u6570\u636e</p> <pre><code>$ cd data/v_offline_patch/amd64/files\n\n$ MINIO_USER=${username} MINIO_PASS=${password} ./import_files.sh ${minio_address}\n</code></pre> <ul> <li><code>minio_address</code> \u662f <code>minio API Server</code> \u5730\u5740\uff0c\u7aef\u53e3\u4e00\u822c\u4e3a9000\uff0c\u6bd4\u5982 <code>http://1.2.3.4:9000</code>\u3002</li> </ul> <p>(2). \u5411 docker registry (\u7248\u672c\u63a8\u8350\u4f7f\u75282.6.2) \u6216\u8005 harbor \u5199\u5165\u955c\u50cf\u6570\u636e</p> <pre><code>$ cd data/v_offline_patch/amd64/images # 1. \u975e\u5b89\u5168\u514d\u5bc6\u6a21\u5f0f\n$ DEST_TLS_VERIFY=false ./import_images.sh ${registry_address}\n\n# 2. \u7528\u6237\u540d\u53e3\u4ee4\u6a21\u5f0f\n$ DEST_USER=${username} DEST_PASS=${password} ./import_images.sh ${registry_address}\n</code></pre> <ul> <li>\u5f53 <code>DEST_TLS_VERIFY=false</code>, \u6b64\u65f6\u91c7\u7528\u975e\u5b89\u5168 HTTP \u6a21\u5f0f\u4e0a\u4f20\u955c\u50cf\u3002</li> <li>\u5f53\u955c\u50cf\u4ed3\u5e93\u5b58\u5728\u7528\u6237\u540d\u5bc6\u7801\u9a8c\u8bc1\u65f6\uff0c\u9700\u8981\u8bbe\u7f6e <code>DEST_USER</code> \u548c <code>DEST_PASS</code>\u3002</li> <li><code>registry_address</code> \u662f\u955c\u50cf\u4ed3\u5e93\u7684\u5730\u5740\uff0c\u6bd4\u5982<code>1.2.3.4:5000</code>\u3002</li> </ul> <p>(3). \u5c06 <code>kubeanofflineversion.cr.patch.yaml</code> \u5199\u5165\u5230 k8s \u96c6\u7fa4</p> <pre><code>$ cd data/v_offline_patch\n$ kubectl apply -f kubeanofflineversion.cr.patch.yaml </code></pre> <ul> <li>\u8be5\u6b65\u9aa4\u662f\u4e3a\u4e86\u5c06\u65b0\u7684\u53ef\u79bb\u7ebf\u4f7f\u7528\u7684\u8f6f\u4ef6\u7248\u672c\u4fe1\u606f\u544a\u77e5 kubean-operator\u3002</li> </ul>"},{"location":"usage/all-in-one-install/","title":"\u591a\u5408\u4e00\u6a21\u5f0f\u6700\u5c0f\u5316\u90e8\u7f72\u96c6\u7fa4","text":""},{"location":"usage/all-in-one-install/#_2","title":"\u524d\u7f6e\u6761\u4ef6","text":"<ol> <li>\u60a8\u5df2\u62e5\u6709\u4e00\u4e2a\u6807\u51c6 kubernetes \u96c6\u7fa4\u6216\u4e91\u5382\u5546\u63d0\u4f9b\u7684\u96c6\u7fa4\u3002</li> <li>\u96c6\u7fa4\u63a7\u5236\u8282\u70b9\u6216\u4e91\u7ec8\u7aef\u5df2\u5c06\u5b89\u88c5\u4e86 kubectl \u5de5\u5177\u3002</li> <li>kubean helm chart \u5df2\u5728\u60a8\u7684\u96c6\u7fa4\u4e0a\u90e8\u7f72\u3002</li> <li>kubean \u9879\u76ee\u5df2\u7ecf\u514b\u9686\u81f3\u60a8\u672c\u5730\uff0c\u5982\u679c\u60a8\u8fd8\u672a\u514b\u9686 kubean\uff0c\u53ef\u4ee5\u6267\u884c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u8fdb\u884c\u514b\u9686\uff1a</li> </ol> <pre><code>$ git clone https://github.com/kubean-io/kubean.git\n</code></pre>"},{"location":"usage/all-in-one-install/#_3","title":"\u5f00\u59cb\u90e8\u7f72","text":"<p>\u672c\u6559\u7a0b\u5c06\u4f7f\u7528\u60a8\u514b\u9686\u81f3\u672c\u5730\u7684 <code>kubean/example</code> \u6587\u4ef6\u4f5c\u4e3a\u8303\u4f8b\u6a21\u7248\uff0c\u8fdb\u884c\u96c6\u7fa4\u90e8\u7f72\u6f14\u793a\u3002</p> <p>\u501f\u52a9\u6848\u4f8b\u6a21\u7248\uff0c\u4ec5\u9700\u4e24\u6b65\u6211\u4eec\u5c31\u80fd\u4f7f\u7528 kubean \u5b8c\u6210\u4e00\u4e2a\u5355\u8282\u70b9\u96c6\u7fa4\u7684\u90e8\u7f72\u3002</p>"},{"location":"usage/all-in-one-install/#1-allinoneyml","title":"1. \u914d\u7f6e AllInOne.yml \u53c2\u6570","text":"<p>\u8fdb\u5165 <code>kubean/examples/install/1.minimal</code> \u6587\u4ef6\u8def\u5f84\u4e0b\uff0c\u7f16\u8f91\u5355\u8282\u70b9\u6a21\u5f0f\u90e8\u7f72\u6a21\u7248 AllInOne.yml\uff0c\u5c06\u4e0b\u5217\u53c2\u6570\u66ff\u6362\u4e3a\u60a8\u7684\u771f\u5b9e\u53c2\u6570\u3002</p> <ul> <li><code>&lt;IP1&gt;</code>\uff1a\u8282\u70b9 IP\u3002</li> <li><code>&lt;USERNAME&gt;</code>\uff1a\u767b\u9646\u8282\u70b9\u7684\u7528\u6237\u540d\uff0c\u5efa\u8bae\u4f7f\u7528 root \u6216\u5177\u6709 root \u6743\u9650\u7684\u7528\u6237\u767b\u9646\u3002</li> <li><code>&lt;PASSWORD&gt;</code>\uff1a\u767b\u9646\u8282\u70b9\u7684\u5bc6\u7801\u3002</li> <li><code>&lt;TAG&gt;</code>\uff1akubean \u955c\u50cf\u7248\u672c\uff0c\u63a8\u8350\u4f7f\u7528\u6700\u65b0\u7248\u672c\uff0c\u53c2\u9605 kubean \u7248\u672c\u5217\u8868\u3002</li> </ul> <p>\u4f8b\u5982\uff0c\u4e0b\u9762\u5c55\u793a\u4e86\u4e00\u4e2a AllInOne.yml \u793a\u4f8b\uff1a</p> AllInOne.yml \u793a\u4f8b <pre><code>---\napiVersion: v1\nkind: ConfigMap\nmetadata:\nname: mini-hosts-conf\nnamespace: kubean-system\ndata:\nhosts.yml: |\nall:\nhosts:\nnode1:\nip: 10.6.175.10 # \u4f60\u7684\u8282\u70b9 IP\naccess_ip: 10.6.175.10 # \u4f60\u7684\u8282\u70b9 IP\nansible_host: 10.6.175.10 # \u4f60\u7684\u8282\u70b9 IP\nansible_connection: ssh\nansible_user: root # \u767b\u9646\u8282\u70b9\u7684\u7528\u6237\u540d\nansible_password: password01 # \u767b\u9646\u8282\u70b9\u7684\u5bc6\u7801\nchildren:\nkube_control_plane:\nhosts:\nnode1:\nkube_node:\nhosts:\nnode1:\netcd:\nhosts:\nnode1:\nk8s_cluster:\nchildren:\nkube_control_plane:\nkube_node:\ncalico_rr:\nhosts: {}\n\n---\napiVersion: v1\nkind: ConfigMap\nmetadata:\nname: mini-vars-conf\nnamespace: kubean-system\ndata:\ngroup_vars.yml: |\ncontainer_manager: containerd\nkube_network_plugin: calico\netcd_deployment_type: kubeadm\n\n---\napiVersion: kubean.io/v1alpha1\nkind: Cluster\nmetadata:\nname: cluster-mini\nlabels:\nclusterName: cluster-mini\nspec:\nhostsConfRef:\nnamespace: kubean-system\nname: mini-hosts-conf\nvarsConfRef:\nnamespace: kubean-system\nname:  mini-vars-conf\n\n---\napiVersion: kubean.io/v1alpha1\nkind: ClusterOperation\nmetadata:\nname: cluster-mini-install-ops\nspec:\ncluster: cluster-mini\nimage: ghcr.m.daocloud.io/kubean-io/spray-job:v0.5.2 # kubean \u955c\u50cf\u7248\u672c\nbackoffLimit: 0\nactionType: playbook\naction: cluster.yml\npreHook:\n- actionType: playbook\naction: disable-firewalld.yml\npostHook:\n- actionType: playbook\naction: cluster-info.yml\n</code></pre> <p>\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u7f16\u8f91 AllInOne.yml \u914d\u7f6e\u6a21\u7248\uff1a</p> <pre><code>$ vi kubean/examples/install/1.minimal/AllInOne.yml\n</code></pre>"},{"location":"usage/all-in-one-install/#2-allinoneyml","title":"2.\u5e94\u7528 AllInOne.yml \u914d\u7f6e","text":"<p>\u5b8c\u6210\u4e0a\u8ff0\u6b65\u9aa4\u5e76\u4fdd\u5b58 AllInOne.yml \u6587\u4ef6\u540e\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>$ kubectl apply -f examples/install/1.minimal/AllInOne.yml\n</code></pre> <p>\u81f3\u6b64\uff0c\u60a8\u5df2\u7ecf\u5b8c\u6210\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u5355\u8282\u70b9\u96c6\u7fa4\u7684\u90e8\u7f72\u3002</p>"},{"location":"usage/helm-install-kubean/","title":"\u5b89\u88c5 kubean helm \u5e94\u7528","text":""},{"location":"usage/helm-install-kubean/#_1","title":"\u524d\u7f6e\u6761\u4ef6","text":"<ol> <li>\u60a8\u5df2\u62e5\u6709\u4e00\u4e2a\u6807\u51c6 kubernetes \u96c6\u7fa4\u6216\u4e91\u5382\u5546\u63d0\u4f9b\u7684\u96c6\u7fa4\u3002</li> <li>\u5728\u60a8\u7684\u96c6\u7fa4\u63a7\u5236\u8282\u70b9\u6216\u4e91\u7ec8\u7aef\u4e0a\u5df2\u5b8c\u6210 Helm \u5de5\u5177\u7684\u5b89\u88c5\u3002\u5982\u4f55\u5b89\u88c5 Helm \u5de5\u5177\u3002</li> </ol>"},{"location":"usage/helm-install-kubean/#_2","title":"\u5f00\u59cb\u90e8\u7f72","text":""},{"location":"usage/helm-install-kubean/#1-kubean-helm","title":"1. \u6dfb\u52a0 kubean Helm \u4ed3\u5e93","text":"<p>\u5c06 kubean Helm \u4ed3\u5e93\u6dfb\u52a0\u5230\u672c\u5730 Helm \u4ed3\u5e93\uff0c\u5728\u73b0\u6709\u96c6\u7fa4\u63a7\u5236\u8282\u70b9\u6216\u4e91\u7ec8\u7aef\u4e0a\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u3002</p> <p><pre><code>$ helm repo add kubean-io https://kubean-io.github.io/kubean-helm-chart/\n</code></pre> \u5b8c\u6210\u4e0a\u4e00\u6b65\u540e\u68c0\u67e5 kubean \u4ed3\u5e93\u662f\u5426\u5df2\u7ecf\u6b63\u786e\u6dfb\u52a0\u81f3\u672c\u5730 Helm \u4ed3\u5e93\u3002</p> <pre><code>$ helm repo list\n# \u9884\u671f\u8f93\u51fa\u5982\u4e0b\uff1a\nNAME            URL\nkubean-io       https://kubean-io.github.io/kubean-helm-chart/\n</code></pre>"},{"location":"usage/helm-install-kubean/#2-kubean","title":"2. \u5b89\u88c5 kubean","text":"<p>\u68c0\u67e5 kubean Helm \u4ed3\u5e93\u4e2d\u53ef\u7528\u7684 Chart \u53ca\u5176\u7248\u672c\uff0c\u6267\u884c\u4e0b\u9762\u547d\u4ee4\u5c06\u5217\u51fa kubean Helm \u4ed3\u5e93\u5185\u6240\u6709\u7684 Chart \u5217\u8868\u3002</p> <pre><code>helm search repo kubean\n\n# \u9884\u671f\u8f93\u51fa\u5982\u4e0b\uff1a\nNAME                CHART VERSION   APP VERSION DESCRIPTION\nkubean-io/kubean    v0.5.2          v0.5.2      A Helm chart for kubean\n</code></pre> <p>\u5b8c\u6210\u4e0a\u8ff0\u6b65\u9aa4\u540e\uff0c\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u5b89\u88c5 kubean\u3002</p> <pre><code>$ helm install kubean kubean-io/kubean --create-namespace -n kubean-system\n</code></pre> <p>Note</p> <p>\u60a8\u8fd8\u53ef\u4ee5\u4f7f\u7528 \"--version\" \u53c2\u6570\u6765\u6307\u5b9a kubean \u7684\u7248\u672c\u3002</p>"},{"location":"usage/helm-install-kubean/#3-kubean-release","title":"3. \u67e5\u770b\u5df2\u5b89\u88c5\u7684 kubean release","text":"<p>\u81f3\u6b64\uff0c\u60a8\u5df2\u7ecf\u5b8c\u6210\u4e86 kubean helm chart \u7684\u90e8\u7f72\uff0c\u60a8\u53ef\u4ee5\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u67e5\u770b kubean-system \u547d\u540d\u7a7a\u95f4\u4e0b\u7684 helm release\u3002</p> <pre><code>$ helm ls -n kubean-system\n\n# \u9884\u671f\u8f93\u51fa\u5982\u4e0b\uff1a\nNAME    NAMESPACE       REVISION    UPDATED                                     STATUS      CHART               APP VERSION\nkubean  kubean-system   1           2023-05-15 00:24:32.719770617 -0400 -0400   deployed    kubean-v0.4.9-rc1   v0.4.9-rc1\n</code></pre>"},{"location":"usage/mirror-install/","title":"\u4f7f\u7528\u52a0\u901f\u6a21\u5f0f\u90e8\u7f72\u96c6\u7fa4","text":""},{"location":"usage/mirror-install/#_2","title":"\u524d\u7f6e\u6761\u4ef6","text":"<ol> <li>\u60a8\u5df2\u62e5\u6709\u4e00\u4e2a\u6807\u51c6 kubernetes \u96c6\u7fa4\u6216\u4e91\u5382\u5546\u63d0\u4f9b\u7684\u96c6\u7fa4\u3002</li> <li>\u96c6\u7fa4\u63a7\u5236\u8282\u70b9\u6216\u4e91\u7ec8\u7aef\u5df2\u5c06\u5b89\u88c5\u4e86 kubectl \u5de5\u5177\u3002</li> <li>kubean helm chart \u5df2\u5728\u60a8\u7684\u96c6\u7fa4\u4e0a\u90e8\u7f72\u3002</li> <li>kubean \u9879\u76ee\u5df2\u7ecf\u514b\u9686\u81f3\u60a8\u672c\u5730\uff0c\u5982\u679c\u60a8\u8fd8\u672a\u514b\u9686 kubean\uff0c\u53ef\u4ee5\u6267\u884c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u8fdb\u884c\u514b\u9686\uff1a</li> </ol> <pre><code>$ git clone https://github.com/kubean-io/kubean.git\n</code></pre>"},{"location":"usage/mirror-install/#_3","title":"\u5f00\u59cb\u90e8\u7f72","text":"<p>\u672c\u6559\u7a0b\u5c06\u4f7f\u7528\u60a8\u514b\u9686\u81f3\u672c\u5730\u7684 <code>kubean/example/2.mirror</code> \u6587\u4ef6\u4f5c\u4e3a\u8303\u4f8b\u6a21\u7248\uff0c\u8fdb\u884c\u96c6\u7fa4\u52a0\u901f\u90e8\u7f72\u6f14\u793a\u3002</p> <p>\u5728\u52a0\u901f\u90e8\u7f72\u6a21\u7248 <code>2.mirror</code> \u5185\u5df2\u7ecf\u5185\u7f6e\u4e86\u52a0\u901f\u53c2\u6570\u914d\u7f6e\uff0c\u60a8\u53ea\u9700\u8981\u5c06 <code>/2.mirror</code>\u6587\u4ef6\u8def\u5f84\u4e0b\u7684 <code>HostsConfCM.yml</code>  \u548c <code>ClusterOperation.yml</code> \u4e24\u4e2a\u914d\u7f6e\u6a21\u7248\u6587\u4ef6\u5185\u7684\u4e3b\u673a\u7b49\u4fe1\u606f\u6539\u6210\u60a8\u7684\u771f\u5b9e\u53c2\u6570\u3002</p>  2.mirror` \u6587\u4ef6\u5185\u4e3b\u8981\u7684\u914d\u7f6e\u6587\u4ef6\u53ca\u7528\u9014\u5982\u4e0b\uff1a <pre><code>    .2.mirror\n\u251c\u2500\u2500 Cluster.yml                        # \u5f85\u5efa\u96c6\u7fa4\u4fe1\u606f\u7684\u62bd\u8c61\n\u251c\u2500\u2500 ClusterOperation.yml        # kubean \u7248\u672c\u53ca\u4efb\u52a1\u914d\u7f6e\n\u251c\u2500\u2500 HostsConfCM.yml              # \u5f85\u5efa\u96c6\u7fa4\u7684\u8282\u70b9\u4fe1\u606f\u914d\u7f6e\n\u2514\u2500\u2500 VarsConfCM.yml                # \u52a0\u901f\u7b49\u5b83\u7279\u6027\u914d\u7f6e\n</code></pre>"},{"location":"usage/mirror-install/#1-hostsconfcmyml","title":"1. \u914d\u7f6e\u4e3b\u673a\u914d\u7f6e\u53c2\u6570 HostsConfCM.yml","text":"<p>\u8fdb\u5165 <code>kubean/examples/install/2.mirror/</code> \u8def\u5f84\uff0c\u7f16\u8f91\u5f85\u5efa\u96c6\u7fa4\u8282\u70b9\u914d\u7f6e\u4fe1\u606f\u6a21\u7248 <code>HostsConfCM.yml</code>\uff0c\u5c06\u4e0b\u5217\u53c2\u6570\u66ff\u6362\u4e3a\u60a8\u7684\u771f\u5b9e\u53c2\u6570\uff1a</p> <ul> <li><code>&lt;IP1&gt;</code>\uff1a\u8282\u70b9 IP\u3002</li> <li><code>&lt;USERNAME&gt;</code>\uff1a\u767b\u9646\u8282\u70b9\u7684\u7528\u6237\u540d\uff0c\u5efa\u8bae\u4f7f\u7528 root \u6216\u5177\u6709 root \u6743\u9650\u7684\u7528\u6237\u767b\u9646\u3002</li> <li><code>&lt;PASSWORD&gt;</code>\uff1a\u767b\u9646\u8282\u70b9\u7684\u5bc6\u7801\u3002</li> </ul> <p>\u4f8b\u5982\uff0c\u4e0b\u9762\u5c55\u793a\u4e86\u4e00\u4e2a HostsConfCM.yml \u793a\u4f8b\uff1a</p>  HostsConfCM.yml \u793a\u4f8b <pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\nname: online-hosts-conf\nnamespace: kubean-system\ndata:\nhosts.yml: |\nall:\nhosts:\nnode1:\nip: 10.6.175.10 # \u4f60\u7684\u8282\u70b9 IP\naccess_ip: 10.6.175.10 # \u4f60\u7684\u8282\u70b9 IP\nansible_host: 10.6.175.10 # \u4f60\u7684\u8282\u70b9 IP\nansible_connection: ssh\nansible_user: root # \u767b\u9646\u8282\u70b9\u7684\u7528\u6237\u540d\nansible_password: password01 # \u767b\u9646\u8282\u70b9\u7684\u5bc6\u7801\nnode2:\nip: 10.6.175.20 # \u8282\u70b9 2 \u7684 IP\naccess_ip: 10.6.175.20 # \u8282\u70b9 2 IP\nansible_host: 10.6.175.20 # \u8282\u70b9\u7684 2 IP\nansible_connection: ssh\nansible_user: root # \u767b\u9646\u8282\u70b9 2 \u7684\u7528\u6237\u540d\nansible_password: password01 # \u767b\u9646\u8282\u70b9 2 \u7684\u5bc6\u7801\nchildren:\nkube_control_plane: # \u914d\u7f6e\u96c6\u7fa4\u63a7\u5236\u8282\u70b9\nhosts:\nnode1:\nkube_node: # \u914d\u7f6e\u96c6\u7fa4\u5de5\u4f5c\u8282\u70b9\nhosts:\nnode1:\nnode2:\netcd: # \u914d\u7f6e\u96c6\u7fa4 ETCD \u8282\u70b9\nhosts:\nnode1:\nk8s_cluster:\nchildren:\nkube_control_plane:\nkube_node:\ncalico_rr:\nhosts: {}\n</code></pre> <p>\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u7f16\u8f91 HostsConfCM.yml \u914d\u7f6e\u6a21\u7248\uff1a</p> <pre><code>$ vi kubean/examples/install/2.mirror/HostsConfCM.yml\n</code></pre>"},{"location":"usage/mirror-install/#2-kubean-clusteroperationyml","title":"2. \u914d\u7f6e kubean \u4efb\u52a1\u914d\u7f6e\u53c2\u6570 ClusterOperation.yml","text":"<p>\u8fdb\u5165 <code>kubean/examples/install/2.mirror/</code> \u8def\u5f84\uff0c\u7f16\u8f91\u5f85\u5efa\u96c6\u7fa4\u8282\u70b9\u914d\u7f6e\u4fe1\u606f\u6a21\u7248 <code>ClusterOperation.yml</code>\uff0c\u5c06\u4e0b\u5217\u53c2\u6570\u66ff\u6362\u4e3a\u60a8\u7684\u771f\u5b9e\u53c2\u6570\uff1a</p> <ul> <li><code>&lt;TAG&gt;</code>\uff1akubean \u955c\u50cf\u7248\u672c\uff0c\u63a8\u8350\u4f7f\u7528\u6700\u65b0\u7248\u672c\uff0c\u53c2\u9605 kubean \u7248\u672c\u5217\u8868\u3002</li> </ul> <p>\u4f8b\u5982\uff0c\u4e0b\u9762\u5c55\u793a\u4e86\u4e00\u4e2a ClusterOperation.yml \u793a\u4f8b\uff1a</p>  ClusterOperation.yml \u793a\u4f8b <pre><code>apiVersion: kubean.io/v1alpha1\nkind: ClusterOperation\nmetadata:\nname: cluster1-online-install-ops\nspec:\ncluster: cluster1-online\nimage: ghcr.m.daocloud.io/kubean-io/spray-job:v0.5.2 # kubean \u955c\u50cf\u7248\u672c\nbackoffLimit: 0\nactionType: playbook\naction: cluster.yml\npreHook:\n- actionType: playbook\naction: ping.yml\n- actionType: playbook\naction: disable-firewalld.yml\npostHook:\n- actionType: playbook\naction: kubeconfig.yml\n- actionType: playbook\naction: cluster-info.yml\n</code></pre> <p>\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u7f16\u8f91 ClusterOperation.yml \u914d\u7f6e\u6a21\u7248\uff1a</p> <pre><code>$ vi kubean/examples/install/2.mirror/ClusterOperation.yml\n</code></pre>"},{"location":"usage/mirror-install/#3-2mirror","title":"3.\u5e94\u7528 2.mirror \u6587\u4ef6\u4e0b\u6240\u6709\u7684\u914d\u7f6e","text":"<p>\u5b8c\u6210\u4e0a\u8ff0\u6b65\u9aa4\u5e76\u4fdd\u5b58 HostsConfCM.yml \u548c ClusterOperation.yml \u6587\u4ef6\u540e\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>$ kubectl apply -f examples/install/2.mirror\n</code></pre> <p>\u81f3\u6b64\uff0c\u60a8\u5df2\u7ecf\u4f7f\u7528\u52a0\u901f\u6a21\u5f0f\u5b8c\u6210\u4e86\u4e00\u4e2a\u96c6\u7fa4\u7684\u90e8\u7f72\u3002</p>"},{"location":"usage/scale-worknode/","title":"\u96c6\u7fa4\u5de5\u4f5c\u8282\u70b9\u6269\u7f29\u5bb9","text":"<p>\u5728\u8f6f\u4ef6\u5f00\u53d1\u8fd0\u7ef4\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e1a\u52a1\u7684\u53d1\u5c55\u5f80\u5f80\u9700\u8981\u6dfb\u52a0\u96c6\u7fa4\u7684\u5de5\u4f5c\u8282\u70b9\u4ee5\u6ee1\u8db3\u4e1a\u52a1\u589e\u957f\uff0c\u5bf9\u4e8e\u4f7f\u7528 kubean \u90e8\u7f72\u7684\u96c6\u7fa4\uff0c\u5728 kubean \u4e2d\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u58f0\u660e\u5f0f\u7684\u65b9\u5f0f\uff0c\u5feb\u901f\u6269\u7f29\u5bb9\u96c6\u7fa4\u5de5\u4f5c\u8282\u70b9\u3002</p> <p>\u5728\u60a8\u514b\u9686\u81f3\u672c\u5730\u7684 <code>kubean/example/scale</code> \u6587\u4ef6\u5185\uff0c\u540c\u6837\u63d0\u4f9b\u4e86\u5de5\u4f5c\u8282\u70b9\u6269\u7f29\u5bb9\u7684\u6837\u4f8b\u6a21\u7248\uff1a</p>  sacle \u6587\u4ef6\u5185\u4e3b\u8981\u7684\u914d\u7f6e\u6587\u4ef6\u53ca\u7528\u9014\u5982\u4e0b\uff1a <pre><code>    scale\n\u251c\u2500\u2500 1.addWorkNode                             # \u589e\u52a0\u5de5\u4f5c\u8282\u70b9\u6a21\u7248\n\u2502   \u251c\u2500\u2500 ClusterOperation.yml                       # kubean \u7248\u672c\u53ca\u4efb\u52a1\u914d\u7f6e\n\u2502   \u2514\u2500\u2500 HostsConfCM.yml                            #\u5f53\u524d\u96c6\u7fa4\u7684\u8282\u70b9\u4fe1\u606f\u914d\u7f6e\n\u2514\u2500\u2500 2.delWorkNode                             # \u5220\u9664\u5de5\u4f5c\u8282\u70b9\u6a21\u7248\n\u2502   \u251c\u2500\u2500 ClusterOperation.yml                       # kubean \u7248\u672c\u53ca\u4efb\u52a1\u914d\u7f6e\n\u2502   \u2514\u2500\u2500 HostsConfCM.yml                             #\u5f53\u524d\u96c6\u7fa4\u7684\u8282\u70b9\u4fe1\u606f\u914d\u7f6e\n</code></pre> <p>\u89c2\u5bdf\u4f38\u7f29\u914d\u7f6e\u6a21\u7248 <code>scale</code> \u6587\u4ef6\u53ef\u4ee5\u53d1\u73b0\uff0c\u5bf9\u96c6\u7fa4\u5de5\u4f5c\u8282\u70b9\u8fdb\u884c\u6269\u7f29\u5bb9\u53ea\u9700\u6267\u884c <code>HostsConfCM.yml</code> \u548c <code>ClusterOperation.yml</code> \u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6\uff0c\u5e76\u5c06\u65b0\u589e\u8282\u70b9\u4fe1\u606f\u7b49\u53c2\u6570\u6539\u6210\u66ff\u6362\u6210\u60a8\u7684\u771f\u5b9e\u53c2\u6570\u3002</p> <p>\u4e0b\u9762\u4ee5\u4f7f\u7528 all-in-one \u6a21\u5f0f\u90e8\u7f72\u7684\u5355\u8282\u70b9\u96c6\u7fa4\u4e3a\u4f8b\uff0c\u6765\u6f14\u793a\u96c6\u7fa4\u8282\u70b9\u7684\u6269\u7f29\u5bb9\u64cd\u4f5c\u3002</p> <p>\u6ce8\u610f\uff1a\u6267\u884c\u96c6\u7fa4\u6269\u7f29\u5bb9\u524d\uff0c\u60a8\u5fc5\u987b\u5df2\u7ecf\u4f7f\u7528 kubean \u5b8c\u6210\u4e86\u4e00\u5957\u96c6\u7fa4\u7684\u90e8\u7f72\u3002</p>"},{"location":"usage/scale-worknode/#_2","title":"\u6269\u5bb9\u5de5\u4f5c\u8282\u70b9","text":""},{"location":"usage/scale-worknode/#1-hostsconfcmyml","title":"1. \u5411 HostsConfCM.yml \u589e\u52a0\u65b0\u8282\u70b9\u4e3b\u673a\u53c2\u6570","text":"<p>\u6211\u4eec\u8981\u5728\u539f\u6709\u7684 all-in-one \u6a21\u5f0f\u4e2d\uff0c\u5bf9\u540d\u4e3a <code>mini-hosts-conf</code> \u7684 ConfigMap \u8fdb\u884c\u65b0\u589e\u8282\u70b9\u914d\u7f6e\uff0c\u5728\u539f\u6765 <code>node1</code> \u4e3b\u8282\u70b9\u7684\u57fa\u7840\u4e0a, \u65b0\u589e <code>node2</code> \u5de5\u4f5c\u8282\u70b9\uff1b</p> <p>\u5177\u4f53\u5730\uff0c\u6211\u4eec\u53ef\u4ee5\u8fdb\u5165 <code>kubean/examples/scale/1.addWorkNode/</code> \u8def\u5f84\uff0c\u7f16\u8f91\u5df2\u51c6\u5907\u597d\u7684\u8282\u70b9\u914d\u7f6e ConfigMap \u6a21\u7248 <code>HostsConfCM.yml</code>\uff0c\u5c06\u4e0b\u5217\u53c2\u6570\u66ff\u6362\u4e3a\u60a8\u7684\u771f\u5b9e\u53c2\u6570\uff1a</p> <ul> <li><code>&lt;IP2&gt;</code>\uff1a\u8282\u70b9 IP\u3002</li> <li><code>&lt;USERNAME&gt;</code>\uff1a\u767b\u9646\u8282\u70b9\u7684\u7528\u6237\u540d\uff0c\u5efa\u8bae\u4f7f\u7528 root \u6216\u5177\u6709 root \u6743\u9650\u7684\u7528\u6237\u767b\u9646\u3002</li> <li><code>&lt;PASSWORD&gt;</code>\uff1a\u767b\u9646\u8282\u70b9\u7684\u5bc6\u7801\u3002</li> </ul> <p><code>kubean/examples/scale/1.addWorkNode/</code> \u8def\u5f84\u4e0b <code>HostsConfCM.yml</code> \u7684\u6a21\u7248\u5185\u5bb9\u5982\u4e0b\uff1a</p>  HostsConfCM.yml \u6a21\u677f <pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\nname: mini-hosts-conf\nnamespace: kubean-system\ndata:\nhosts.yml: |\nall:\nhosts:\nnode1:\nip: &lt;IP1&gt;\naccess_ip: &lt;IP1&gt;\nansible_host: &lt;IP1&gt;\nansible_connection: ssh\nansible_user: &lt;USERNAME&gt;\nansible_password: &lt;PASSWORD&gt;\nnode2:\nip: &lt;IP2&gt;\naccess_ip: &lt;IP2&gt;\nansible_host: &lt;IP2&gt;\nansible_connection: ssh\nansible_user: &lt;USERNAME&gt;\nansible_password: &lt;PASSWORD&gt;\nchildren:\nkube_control_plane:\nhosts:\nnode1:\nkube_node:\nhosts:\nnode1:\nnode2:\netcd:\nhosts:\nnode1:\nk8s_cluster:\nchildren:\nkube_control_plane:\nkube_node:\ncalico_rr:\nhosts: {}\n</code></pre> <p>\u91cd\u8981\u53c2\u6570\uff1a</p> <ul> <li><code>all.hosts.node1</code>: \u539f\u96c6\u7fa4\u4e2d\u5df2\u5b58\u5728\u7684\u4e3b\u8282\u70b9</li> <li><code>all.hosts.node2</code>: \u96c6\u7fa4\u6269\u5bb9\u5f85\u65b0\u589e\u7684\u5de5\u4f5c\u8282\u70b9</li> <li><code>all.children.kube_node.hosts</code>: \u96c6\u7fa4\u4e2d\u7684\u5de5\u4f5c\u8282\u70b9\u7ec4</li> </ul> <p>\u65b0\u589e\u5de5\u4f5c\u8282\u70b9\u4e3b\u673a\u53c2\u6570\u7684\u793a\u4f8b</p> \u65b0\u589e\u8282\u70b9\u524d\u65b0\u589e\u8282\u70b9\u540e <pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\nname: mini-hosts-conf\nnamespace: kubean-system\ndata:\nhosts.yml: |\nall:\nhosts:\nnode1:\nip: 10.6.175.10 # \u4f60\u7684\u8282\u70b9 IP\naccess_ip: 10.6.175.10 # \u4f60\u7684\u8282\u70b9 IP\nansible_host: 10.6.175.10 # \u4f60\u7684\u8282\u70b9 IP\nansible_connection: ssh\nansible_user: root # \u767b\u9646\u8282\u70b9\u7684\u7528\u6237\u540d\nansible_password: password01 # \u767b\u9646\u8282\u70b9\u7684\u5bc6\u7801\nchildren:\nkube_control_plane:\nhosts:\nnode1:\nkube_node:\nhosts:\nnode1:\netcd:\nhosts:\nnode1:\nk8s_cluster:\nchildren:\nkube_control_plane:\nkube_node:\ncalico_rr:\nhosts: {}\n</code></pre> <pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\nname: mini-hosts-conf\nnamespace: kubean-system\ndata:\nhosts.yml: |\nall:\nhosts:\nnode1:\nip: 10.6.175.10 # \u4f60\u7684\u8282\u70b9 IP\naccess_ip: 10.6.175.10 # \u4f60\u7684\u8282\u70b9 IP\nansible_host: 10.6.175.10 # \u4f60\u7684\u8282\u70b9 IP\nansible_connection: ssh\nansible_user: root # \u767b\u9646\u8282\u70b9\u7684\u7528\u6237\u540d\nansible_password: password01 # \u767b\u9646\u8282\u70b9\u7684\u5bc6\u7801\nnode2:\nip: 10.6.175.20 # \u65b0\u589e\u8282\u70b9 2 \u7684 IP\naccess_ip: 10.6.175.20 # \u65b0\u589e\u8282\u70b9 2 \u7684 IP\nansible_host: 10.6.175.20 # \u65b0\u589e\u8282\u70b9\u7684 2 \u7684 IP\nansible_connection: ssh\nansible_user: root # \u767b\u9646\u8282\u70b9 2 \u7684\u7528\u6237\u540d\nansible_password: password01 # \u767b\u9646\u8282\u70b9 2 \u7684\u5bc6\u7801\nchildren:\nkube_control_plane:\nhosts:\nnode1:\nkube_node:\nhosts:\nnode1:\nnode2:\netcd:\nhosts:\nnode1:\nk8s_cluster:\nchildren:\nkube_control_plane:\nkube_node:\ncalico_rr:\nhosts: {}\n</code></pre>"},{"location":"usage/scale-worknode/#2-clusteroperationyml","title":"2. \u901a\u8fc7 ClusterOperation.yml \u65b0\u589e\u6269\u5bb9\u4efb\u52a1","text":"<p>\u8fdb\u5165 <code>kubean/examples/scale/1.addWorkNode/</code> \u8def\u5f84\uff0c\u7f16\u8f91\u6a21\u7248 <code>ClusterOperation.yml</code>\uff0c\u5c06\u4e0b\u5217\u53c2\u6570\u66ff\u6362\u4e3a\u60a8\u7684\u771f\u5b9e\u53c2\u6570\uff1a</p> <ul> <li><code>&lt;TAG&gt;</code>\uff1akubean \u955c\u50cf\u7248\u672c\uff0c\u63a8\u8350\u4f7f\u7528\u6700\u65b0\u7248\u672c\uff0c\u53c2\u9605 kubean \u7248\u672c\u5217\u8868\u3002</li> </ul> <p><code>kubean/examples/scale/1.addWorkNode/</code> \u8def\u5f84\u4e0b <code>ClusterOperation.yml</code> \u7684\u6a21\u7248\u5185\u5bb9\u5982\u4e0b\uff1a</p> <p><pre><code>apiVersion: kubean.io/v1alpha1\nkind: ClusterOperation\nmetadata:\nname: cluster-mini-awn-ops\nspec:\ncluster: cluster-mini\nimage: ghcr.m.daocloud.io/kubean-io/spray-job:&lt;TAG&gt; # Please replace &lt;TAG&gt; with the specified version, such as v0.4.9\nbackoffLimit: 0\nactionType: playbook\naction: scale.yml\nextraArgs: --limit=node2\n</code></pre> \u91cd\u8981\u53c2\u6570\uff1a</p> <ul> <li><code>spec.cluster</code>: \u6307\u5b9a\u9700\u8981\u6269\u5bb9\u8282\u70b9\u7684\u96c6\u7fa4\u540d\u79f0\uff0c\u4e0a\u8ff0\u6307\u5b9a\u7684\u662f\u540d\u4e3a <code>cluster-mini</code> \u7684\u96c6\u7fa4\u4e3a\u6269\u5bb9\u76ee\u6807\u3002</li> <li><code>spec.action:</code> \u6307\u5b9a\u6269\u5bb9\u8282\u70b9\u7684 kubespray \u5267\u672c, \u8fd9\u91cc\u8bbe\u7f6e\u4e3a <code>scale.yml</code>.</li> <li><code>spec.extraArgs</code>: \u6307\u5b9a\u6269\u5bb9\u7684\u8282\u70b9\u9650\u5236\uff0c\u8fd9\u91cc\u901a\u8fc7 <code>--limit=</code> \u53c2\u6570\u9650\u5b9a\u6269\u5bb9 node2 \u8282\u70b9</li> </ul> <p>\u4f8b\u5982\uff0c\u4e0b\u9762\u5c55\u793a\u4e86\u4e00\u4e2a ClusterOperation.yml \u793a\u4f8b\uff1a</p>  ClusterOperation.yml \u793a\u4f8b <pre><code>---\napiVersion: kubean.io/v1alpha1\nkind: ClusterOperation\nmetadata:\nname: cluster-mini-awn-ops\nspec:\ncluster: cluster-mini\nimage: ghcr.m.daocloud.io/kubean-io/spray-job:v0.5.2\nbackoffLimit: 0\nactionType: playbook\naction: scale.yml\nextraArgs: --limit=node2\n</code></pre>"},{"location":"usage/scale-worknode/#3-scale1addworknode","title":"3.\u5e94\u7528 <code>scale/1.addWorkNode</code> \u6587\u4ef6\u4e0b\u6240\u6709\u7684\u914d\u7f6e","text":"<p>\u5b8c\u6210\u4e0a\u8ff0\u6b65\u9aa4\u5e76\u4fdd\u5b58 HostsConfCM.yml \u548c ClusterOperation.yml \u6587\u4ef6\u540e\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>$ kubectl apply -f examples/install/scale/1.addWorkNode/\n</code></pre> <p>\u81f3\u6b64\uff0c\u60a8\u5df2\u7ecf\u4f7f\u5b8c\u6210\u4e86\u4e00\u4e2a\u96c6\u7fa4\u7684\u5de5\u4f5c\u8282\u70b9\u6269\u5bb9\u3002</p>"},{"location":"usage/scale-worknode/#_3","title":"\u7f29\u5bb9\u5de5\u4f5c\u8282\u70b9","text":""},{"location":"usage/scale-worknode/#1-clusteroperationyml","title":"1. \u901a\u8fc7 ClusterOperation.yml \u65b0\u589e\u7f29\u5bb9\u4efb\u52a1","text":"<p>\u8fdb\u5165 <code>kubean/examples/scale/2.delWorkNode/</code> \u8def\u5f84\uff0c\u7f16\u8f91\u6a21\u7248 <code>ClusterOperation.yml</code>\uff0c\u5c06\u4e0b\u5217\u53c2\u6570\u66ff\u6362\u4e3a\u60a8\u7684\u771f\u5b9e\u53c2\u6570\uff1a</p> <ul> <li><code>&lt;TAG&gt;</code>\uff1akubean \u955c\u50cf\u7248\u672c\uff0c\u63a8\u8350\u4f7f\u7528\u6700\u65b0\u7248\u672c\uff0c\u53c2\u9605 kubean \u7248\u672c\u5217\u8868\u3002</li> </ul> <p><code>kubean/examples/scale/2.delWorkNode/</code> \u8def\u5f84\u4e0b <code>ClusterOperation.yml</code> \u7684\u6a21\u7248\u5185\u5bb9\u5982\u4e0b\uff1a</p> <p><pre><code>apiVersion: kubean.io/v1alpha1\nkind: ClusterOperation\nmetadata:\nname: cluster-mini-dwn-ops\nspec:\ncluster: cluster-mini\nimage: ghcr.m.daocloud.io/kubean-io/spray-job:&lt;TAG&gt; # Please replace &lt;TAG&gt; with the specified version, such as v0.4.9\nbackoffLimit: 0\nactionType: playbook\naction: remove-node.yml\nextraArgs: -e node=node2\n</code></pre> \u91cd\u8981\u53c2\u6570\uff1a</p> <ul> <li><code>spec.cluster</code>: \u6307\u5b9a\u9700\u8981\u7f29\u5bb9\u8282\u70b9\u7684\u96c6\u7fa4\u540d\u79f0, \u4e0a\u8ff0\u6307\u5b9a\u7684\u662f\u540d\u4e3a cluster-mini \u7684\u96c6\u7fa4\u4e3a\u7f29\u5bb9\u76ee\u6807\u3002</li> <li><code>spec.action</code>: \u6307\u5b9a\u7f29\u5bb9\u8282\u70b9\u7684 kubespray \u5267\u672c, \u8fd9\u91cc\u8bbe\u7f6e\u4e3a remove-node.yml\u3002</li> <li><code>spec.extraArgs</code>: \u6307\u5b9a\u7f29\u5bb9\u7684\u8282\u70b9\uff0c\u8fd9\u91cc\u901a\u8fc7 -e \u53c2\u6570\u6307\u5b9a\u7f29\u5bb9 node2 \u8282\u70b9</li> </ul> <p>\u4f8b\u5982\uff0c\u4e0b\u9762\u5c55\u793a\u4e86\u4e00\u4e2a ClusterOperation.yml \u793a\u4f8b\uff1a</p>  ClusterOperation.yml \u793a\u4f8b <pre><code>apiVersion: kubean.io/v1alpha1\nkind: ClusterOperation\nmetadata:\nname: cluster-mini-dwn-ops\nspec:\ncluster: cluster-mini\nimage: ghcr.m.daocloud.io/kubean-io/spray-job:v0.5.2\nbackoffLimit: 0\nactionType: playbook\naction: remove-node.yml\nextraArgs: -e node=node2\n</code></pre>"},{"location":"usage/scale-worknode/#2-scale2delworknode-clusteroperation","title":"2.\u5e94\u7528 <code>scale/2.delWorkNode</code> \u76ee\u5f55\u4e0b\u7684 ClusterOperation \u7f29\u5bb9\u4efb\u52a1\u6e05\u5355","text":"<p>\u5b8c\u6210\u4e0a\u8ff0\u6b65\u9aa4\u5e76\u4fdd\u5b58 ClusterOperation.yml \u6587\u4ef6\u540e\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>$ kubectl apply -f examples/install/scale/2.delWorkNode/ClusterOperation.yml\n</code></pre> <p>\u9ed8\u8ba4\u8fdb\u5165 kubean-system \u547d\u540d\u7a7a\u95f4\uff0c\u67e5\u770b\u7f29\u5bb9\u4efb\u52a1\u6267\u884c\u72b6\u6001\uff1a <pre><code>$ kubectl -n kubean-system get pod | grep cluster-mini-dwn-ops\n</code></pre> \u4e86\u89e3\u7f29\u5bb9\u4efb\u52a1\u6267\u884c\u8fdb\u5ea6\uff0c\u53ef\u67e5\u770b\u8be5 pod \u65e5\u5fd7\uff1b</p>"},{"location":"usage/scale-worknode/#3-hostsconfcmyml","title":"3. \u901a\u8fc7 HostsConfCM.yml \u5220\u9664\u5de5\u4f5c\u8282\u70b9\u4e3b\u673a\u53c2\u6570","text":"<p>\u6211\u4eec\u5df2\u7ecf\u901a\u8fc7\u5982\u4e0a\u4e24\u6b65\u64cd\u4f5c\u6267\u884c\u4e86\u7f29\u5bb9\u4efb\u52a1\uff0c\u5f85\u7f29\u5bb9\u4efb\u52a1\u6267\u884c\u5b8c\u6210\u540e\uff0c<code>node2</code> \u5c06\u4ece\u73b0\u6709\u96c6\u7fa4\u4e2d\u6c38\u4e45\u79fb\u9664\uff0c\u5219\u6b64\u65f6\u6211\u4eec\u8fd8\u9700\u8981\u5b8c\u6210\u6700\u540e\u4e00\u6b65\uff0c\u5c06\u8282\u70b9\u914d\u7f6e\u76f8\u5173 Configmap \u4e2d\u7684 node2 \u4fe1\u606f\u79fb\u9664;</p> <p>\u8fdb\u5165 <code>kubean/examples/scale/2.delWorkNode/</code> \u8def\u5f84\uff0c\u7f16\u8f91\u5df2\u51c6\u5907\u597d\u7684\u8282\u70b9\u914d\u7f6e\u6a21\u7248 <code>HostsConfCM.yml</code>\uff0c\u5220\u9664\u9700\u8981\u79fb\u9664\u7684\u5de5\u4f5c\u8282\u70b9\u914d\u7f6e\u3002</p> <p>\u5220\u9664\u53c2\u6570\u5982\u4e0b\uff1a</p> <ul> <li><code>all.hosts</code> \u4e0b\u7684 node2 \u8282\u70b9\u63a5\u5165\u53c2\u6570\u3002</li> <li><code>all.children.kube_node.hosts</code> \u5185\u7684\u4e3b\u673a\u540d\u79f0 node2 \u3002</li> </ul> <p>\u79fb\u9664\u5de5\u4f5c\u8282\u70b9\u4e3b\u673a\u53c2\u6570\u7684\u793a\u4f8b</p> \u79fb\u9664\u8282\u70b9\u524d\u79fb\u9664\u8282\u70b9\u540e <pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\nname: mini-hosts-conf\nnamespace: kubean-system\ndata:\nhosts.yml: |\nall:\nhosts:\nnode1:\nip: 10.6.175.10 # \u4f60\u7684\u8282\u70b9 IP\naccess_ip: 10.6.175.10 # \u4f60\u7684\u8282\u70b9 IP\nansible_host: 10.6.175.10 # \u4f60\u7684\u8282\u70b9 IP\nansible_connection: ssh\nansible_user: root # \u767b\u9646\u8282\u70b9\u7684\u7528\u6237\u540d\nansible_password: password01 # \u767b\u9646\u8282\u70b9\u7684\u5bc6\u7801\nnode2:\nip: 10.6.175.20 # \u65b0\u589e\u8282\u70b9 2 \u7684 IP\naccess_ip: 10.6.175.20 # \u65b0\u589e\u8282\u70b9 2 IP\nansible_host: 10.6.175.20 # \u65b0\u589e\u8282\u70b9\u7684 2 IP\nansible_connection: ssh\nansible_user: root # \u767b\u9646\u8282\u70b9 2 \u7684\u7528\u6237\u540d\nansible_password: password01 # \u767b\u9646\u8282\u70b9 2 \u7684\u5bc6\u7801\nchildren:\nkube_control_plane:\nhosts:\nnode1:\nkube_node:\nhosts:\nnode1:\nnode2:\netcd:\nhosts:\nnode1:\nk8s_cluster:\nchildren:\nkube_control_plane:\nkube_node:\ncalico_rr:\nhosts: {}\n</code></pre> <pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\nname: mini-hosts-conf\nnamespace: kubean-system\ndata:\nhosts.yml: |\nall:\nhosts:\nnode1:\nip: 10.6.175.10 # \u4f60\u7684\u8282\u70b9 IP\naccess_ip: 10.6.175.10 # \u4f60\u7684\u8282\u70b9 IP\nansible_host: 10.6.175.10 # \u4f60\u7684\u8282\u70b9 IP\nansible_connection: ssh\nansible_user: root # \u767b\u9646\u8282\u70b9\u7684\u7528\u6237\u540d\nansible_password: password01 # \u767b\u9646\u8282\u70b9\u7684\u5bc6\u7801\nchildren:\nkube_control_plane:\nhosts:\nnode1:\nkube_node:\nhosts:\nnode1:\netcd:\nhosts:\nnode1:\nk8s_cluster:\nchildren:\nkube_control_plane:\nkube_node:\ncalico_rr:\nhosts: {}\n</code></pre> <p>\u5b8c\u6210\u4e0a\u8ff0\u6b65\u9aa4\u5e76\u4fdd\u5b58 HostsConfCM.yml \u6587\u4ef6\u540e\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>$ kubectl apply -f examples/install/scale/2.delWorkNode/HostsConfCM.yml\n</code></pre> <p>\u6b64\u65f6\uff0c\u6211\u4eec\u5df2\u5c06 node2 \u5de5\u4f5c\u8282\u70b9\u4ece\u96c6\u7fa4\u4e2d\u79fb\u9664\uff0c\u5e76\u4e14\u6e05\u7406\u6389\u4e86\u6709\u5173 node2 \u7684\u4e3b\u673a\u4fe1\u606f\uff0c\u6574\u4e2a\u7f29\u5bb9\u64cd\u4f5c\u5c31\u6b64\u7ed3\u675f\uff1b</p>"},{"location":"usage/sshkey_deploy_cluster/","title":"\u4ee5SSH\u79d8\u94a5\u65b9\u5f0f\u90e8\u7f72\u96c6\u7fa4","text":""},{"location":"usage/sshkey_deploy_cluster/#_1","title":"\u5185\u5bb9","text":"<ul> <li>\u2713 1. SSH \u79d8\u94a5\u7684\u751f\u6210\u4e0e\u5206\u53d1</li> <li>\u2713 2. \u4f7f\u7528\u79c1\u94a5\u5236\u4f5c Secret</li> <li>\u2713 3. \u521b\u5efa\u4e3b\u673a\u6e05\u5355\u914d\u7f6e</li> <li>\u2713 3. \u5236\u5907\u90e8\u7f72\u96c6\u7fa4\u7684\u914d\u7f6e\u53c2\u6570</li> <li>\u2713 4. \u51c6\u5907 KuBean \u7684\u81ea\u5b9a\u4e49\u8d44\u6e90</li> <li>\u2713 5. \u5f00\u59cb\u90e8\u7f72\u96c6\u7fa4</li> </ul>"},{"location":"usage/sshkey_deploy_cluster/#ssh_1","title":"SSH\u79d8\u94a5\u7684\u751f\u6210\u4e0e\u5206\u53d1","text":"<ol> <li>\u901a\u8fc7 <code>ssh-keygen</code> \u547d\u4ee4\u751f\u6210\u516c\u79c1\u94a5\u5bf9\uff0c\u6bd4\u5982\uff1a</li> </ol> <pre><code>$ ssh-keygen -t rsa -b 4096 -C \"your_email@example.com\" -f $HOME/.ssh/id_rsa\nGenerating public/private rsa key pair.\nCreated directory '/root/.ssh'.\nEnter passphrase (empty for no passphrase):\nEnter same passphrase again:\nYour identification has been saved in /root/.ssh/id_rsa.\nYour public key has been saved in /root/.ssh/id_rsa.pub.\nThe key fingerprint is:\nSHA256:oMqlhL8wLuYycOkUNXyiDso62C+ryNYc9k3LMDltQZs your_email@example.com\nThe keys randomart image is:\n+---[RSA 4096]----+\n|   .             |\n|    = ..         |\n|   o +o o        |\n|..o  . E         |\n|+o.oo o S        |\n|o==* = +         |\n|*=O o O .        |\n|@=++ . +         |\n|OBo+.            |\n+----[SHA256]-----+\n\n$ ls /root/.ssh/id_rsa* -lh\n-rw-------. 1 root root 1.7K Nov 10 03:47 /root/.ssh/id_rsa         # \u79c1\u94a5\n-rw-r--r--. 1 root root  408 Nov 10 03:47 /root/.ssh/id_rsa.pub     # \u516c\u94a5\n</code></pre> <ol> <li>\u5206\u53d1\u516c\u94a5\u5230\u96c6\u7fa4\u7684\u5404\u4e2a\u8282\u70b9\uff1a</li> </ol> <pre><code># \u6bd4\u5982\u6307\u5b9a\u5c06\u516c\u94a5\u5206\u53d1\u81f3 `192.168.10.11` `192.168.10.12` \u4e24\u4e2a\u8282\u70b9\n$ declare -a IPS=(192.168.10.11 192.168.10.12)\n\n# \u904d\u5386\u8282\u70b9 IP \u5206\u53d1\u516c\u94a5(/root/.ssh/id_rsa.pub)\uff0c\u5047\u8bbe\u7528\u6237\u540d\u4e3a: root, \u5bc6\u7801\u4e3a: kubean\n$ for ip in ${IPS[@]}; do sshpass -p \"kubean\" ssh-copy-id -i /root/.ssh/id_rsa.pub -o StrictHostKeyChecking=no root@$ip; done\n</code></pre>"},{"location":"usage/sshkey_deploy_cluster/#secret","title":"\u4f7f\u7528\u79c1\u94a5\u5236\u4f5cSecret","text":"<ol> <li>\u901a\u8fc7 kubectl \u547d\u4ee4\u53ef\u4ee5\u751f\u6210\u79c1\u94a5\u7684 Secret:</li> </ol> <pre><code>$ kubectl -n kubean-system \\                            # \u6307\u5b9a\u547d\u540d\u7a7a\u95f4 kubean-system\ncreate secret generic sample-ssh-auth \\             # \u6307\u5b9a secret \u540d\u79f0\u4e3a sample-ssh-auth\n--type='kubernetes.io/ssh-auth' \\                   # \u6307\u5b9a secret \u7c7b\u578b\u4e3a kubernetes.io/ssh-auth\n--from-file=ssh-privatekey=/root/.ssh/id_rsa \\      # \u6307\u5b9a ssh \u79c1\u94a5\u6587\u4ef6\u8def\u5f84\n--dry-run=client -o yaml &gt; SSHAuthSec.yml           # \u6307\u5b9a secret yaml \u6587\u4ef6\u751f\u6210\u8def\u5f84\n</code></pre> <ol> <li>\u751f\u6210\u7684 <code>SSHAuthSec.yml</code> \u5185\u5bb9\u5927\u81f4\u5982\u4e0b\u6240\u793a\uff1a</li> </ol> <pre><code># SSHAuthSec.yml\napiVersion: v1\nkind: Secret\nmetadata:\ncreationTimestamp: null\nname: sample-ssh-auth\nnamespace: kubean-system\ntype: kubernetes.io/ssh-auth\ndata:\nssh-privatekey: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlKS1FJQkFBS0NBZ0VBdWVDbC8rSng1b0RT...\n</code></pre>"},{"location":"usage/sshkey_deploy_cluster/#_2","title":"\u521b\u5efa\u4e3b\u673a\u6e05\u5355\u914d\u7f6e","text":"<p>\u793a\u4f8b\uff1a\u4e3b\u673a\u6e05\u5355 HostsConfCM.yml \u5185\u5bb9\u5927\u81f4\u5982\u4e0b\uff1a</p> <pre><code># HostsConfCM.yml\napiVersion: v1\nkind: ConfigMap\nmetadata:\nname: sample-hosts-conf\nnamespace: kubean-system\ndata:\nhosts.yml: |\nall:\nhosts:\nmaster:\nip: 192.168.10.11\naccess_ip: 192.168.10.11\nansible_host: 192.168.10.11\nworker:\nip: 192.168.10.12\naccess_ip: 192.168.10.12\nansible_host: 192.168.10.12\nchildren:\nkube_control_plane:\nhosts:\nmaster:\nkube_node:\nhosts:\nmaster:\nworker:\netcd:\nhosts:\nmaster:\nk8s_cluster:\nchildren:\nkube_control_plane:\nkube_node:\ncalico_rr:\nhosts: {}\n</code></pre> <p>\u6ce8\uff1a \u7531\u4e8e\u91c7\u7528\u79c1\u94a5\u767b\u5f55\uff0c\u6240\u4ee5\u4e3b\u673a\u4fe1\u606f\u4e2d\u4e0d\u9700\u8981\u586b\u5199\u7528\u6237\u540d\u5bc6\u7801(\u5373: ansible_user\u3001ansible_password)</p>"},{"location":"usage/sshkey_deploy_cluster/#_3","title":"\u5236\u5907\u90e8\u7f72\u96c6\u7fa4\u7684\u914d\u7f6e\u53c2\u6570","text":"<p>\u96c6\u7fa4\u914d\u7f6e\u53c2\u6570 VarsConfCM.yml \u7684\u5185\u5bb9\uff0c\u53ef\u4ee5\u53c2\u8003: demo vars conf\u3002</p> <pre><code># VarsConfCM.yml\napiVersion: v1\nkind: ConfigMap\nmetadata:\nname: sample-vars-conf\nnamespace: kubean-system\ndata:\ngroup_vars.yml: |\ncontainer_manager: containerd\nkube_network_plugin: calico\nkube_network_plugin_multus: false\nkube_proxy_mode: iptables\nenable_nodelocaldns: false\netcd_deployment_type: kubeadm\nntp_enabled: true\n...\n</code></pre>"},{"location":"usage/sshkey_deploy_cluster/#kubean","title":"\u51c6\u5907KuBean\u7684\u81ea\u5b9a\u4e49\u8d44\u6e90","text":"<p>(1). Cluster \u81ea\u5b9a\u4e49\u8d44\u6e90\u5185\u5bb9\u793a\u4f8b</p> <pre><code># Cluster.yml\napiVersion: kubean.io/v1alpha1\nkind: Cluster\nmetadata:\nname: sample\nspec:\nhostsConfRef:\nnamespace: kubean-system\nname: sample-hosts-conf\nvarsConfRef:\nnamespace: kubean-system\nname: sample-vars-conf\nsshAuthRef:                # \u5173\u952e\u5c5e\u6027\uff0c\u6307\u5b9a\u96c6\u7fa4\u90e8\u7f72\u671f\u95f4\u7684 ssh \u79c1\u94a5 secret\nnamespace: kubean-system\nname: sample-ssh-auth\n</code></pre> <p>(2). ClusterOperation \u81ea\u5b9a\u4e49\u8d44\u6e90\u5185\u5bb9\u793a\u4f8b</p> <pre><code># ClusterOperation.yml\napiVersion: kubean.io/v1alpha1\nkind: ClusterOperation\nmetadata:\nname: sample-create-cluster\nspec:\ncluster: sample\nimage: ghcr.m.daocloud.io/kubean-io/spray-job:latest\nbackoffLimit: 0\nactionType: playbook\naction: cluster.yml\npreHook:\n- actionType: playbook\naction: ping.yml\n- actionType: playbook\naction: disable-firewalld.yml\npostHook:\n- actionType: playbook\naction: kubeconfig.yml\n- actionType: playbook\naction: cluster-info.yml\n</code></pre>"},{"location":"usage/sshkey_deploy_cluster/#_4","title":"\u5f00\u59cb\u90e8\u7f72\u96c6\u7fa4","text":"<p>\u5047\u8bbe\u6211\u4eec\u7684\u6240\u6709 yaml \u6e05\u5355\u90fd\u5b58\u653e\u5728 create_cluster \u76ee\u5f55\uff1a</p> <pre><code>$ tree create_cluster/\ncreate_cluster\n\u251c\u2500\u2500 HostsConfCM.yml       # \u4e3b\u673a\u6e05\u5355\n\u251c\u2500\u2500 SSHAuthSec.yml        # SSH\u79c1\u94a5\n\u251c\u2500\u2500 VarsConfCM.yml        # \u96c6\u7fa4\u53c2\u6570\n\u251c\u2500\u2500 Cluster.yml           # Cluster CR\n\u2514\u2500\u2500 ClusterOperation.yml  # ClusterOperation CR\n</code></pre> <p>\u901a\u8fc7 kubectl apply \u5f00\u59cb\u90e8\u7f72\u96c6\u7fa4:</p> <pre><code>$ kubectl apply -f create_cluster/\n</code></pre>"},{"location":"usage/support-k8s-version/","title":"Support k8s version","text":"kubean Version Default Kubernetes Version Supported Kubernetes Version Range v0.5.4 v1.25.4 - \"v1.27.2\"        - \"v1.26.5\"        - \"v1.26.4\"        - \"v1.26.3\"        - \"v1.26.2\"        - \"v1.26.1\"        - \"v1.26.0\"        - \"v1.25.10\"        - \"v1.25.9\"        - \"v1.25.8\"        - \"v1.25.7\"        - \"v1.25.6\"        - \"v1.25.5\"        - \"v1.25.4\"        - \"v1.25.3\"        - \"v1.25.2\"        - \"v1.25.1\"        - \"v1.25.0\""},{"location":"usage/uninstall/","title":"\u96c6\u7fa4\u5378\u8f7d","text":"<p>\u672c\u8282\u5c06\u5411\u60a8\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528 kubean \u5378\u8f7d\u96c6\u7fa4\u3002\u5728\u60a8\u514b\u9686\u81f3\u672c\u5730\u7684 <code>kubean/example/uninstall</code> \u6587\u4ef6\u5185\uff0c\u540c\u6837\u63d0\u4f9b\u4e86\u5378\u8f7d\u96c6\u7fa4\u7684\u6837\u4f8b\u6a21\u7248\uff1a</p>  uninsatall \u6587\u4ef6\u5185\u4e3b\u8981\u7684\u914d\u7f6e\u6587\u4ef6\u53ca\u7528\u9014\u5982\u4e0b\uff1a <pre><code>    uninstall\n\u251c\u2500\u2500 ClusterOperation.yml                # \u5378\u8f7d\u96c6\u7fa4\u4efb\u52a1\n</code></pre> <p>\u4e0b\u9762\u4ee5\u4f7f\u7528 all-in-one \u6a21\u5f0f\u90e8\u7f72\u7684\u5355\u8282\u70b9\u96c6\u7fa4\u4e3a\u4f8b\uff0c\u6765\u6f14\u793a\u96c6\u7fa4\u7248\u672c\u5347\u7ea7\u64cd\u4f5c\u3002</p> <p>\u6ce8\u610f\uff1a\u6267\u884c\u96c6\u7fa4\u5378\u8f7d\u524d\uff0c\u60a8\u5fc5\u987b\u5df2\u7ecf\u4f7f\u7528 kubean \u5b8c\u6210\u4e86\u4e00\u5957\u96c6\u7fa4\u7684\u90e8\u7f72\u3002</p>"},{"location":"usage/uninstall/#1","title":"1. \u65b0\u589e\u5378\u8f7d\u4efb\u52a1","text":"<p>\u8fdb\u5165 <code>kubean/examples/uninstall/</code> \u8def\u5f84\uff0c\u7f16\u8f91\u6a21\u7248 <code>ClusterOperation.yml</code>\uff0c\u5c06\u4e0b\u5217\u53c2\u6570\u66ff\u6362\u4e3a\u60a8\u7684\u771f\u5b9e\u53c2\u6570\uff1a</p> <ul> <li><code>&lt;TAG&gt;</code>\uff1akubean \u955c\u50cf\u7248\u672c\uff0c\u63a8\u8350\u4f7f\u7528\u6700\u65b0\u7248\u672c\uff0c\u53c2\u9605 kubean \u7248\u672c\u5217\u8868\u3002</li> </ul> <p><code>kubean/examples/uninstall/</code> \u8def\u5f84\u4e0b <code>ClusterOperation.yml</code> \u7684\u6a21\u7248\u5185\u5bb9\u5982\u4e0b\uff1a</p> <p><pre><code>apiVersion: kubean.io/v1alpha1\nkind: ClusterOperation\nmetadata:\nname: cluster-mini-uninstall-ops\nspec:\ncluster: cluster-mini\nimage: ghcr.m.daocloud.io/kubean-io/spray-job:&lt;TAG&gt; # Please replace &lt;TAG&gt; with the specified version, such as v0.4.9\nbackoffLimit: 0\nactionType: playbook\naction: reset.yml\n</code></pre> \u91cd\u8981\u53c2\u6570\uff1a</p> <ul> <li><code>spec.cluster</code>\uff1a\u6307\u5b9a\u9700\u8981\u5378\u8f7d\u7684\u96c6\u7fa4\u540d\u79f0, \u4e0a\u8ff0\u6307\u5b9a\u7684\u662f\u540d\u4e3a <code>cluster-mini</code> \u7684\u96c6\u7fa4\u4e3a\u5378\u8f7d\u76ee\u6807\u3002</li> <li><code>spec.action:</code>\uff1a\u6307\u5b9a\u5378\u8f7d\u76f8\u5173\u7684 kubespray \u5267\u672c, \u8fd9\u91cc\u8bbe\u7f6e\u4e3a <code>reset.yml</code>\u3002</li> </ul>"},{"location":"usage/uninstall/#2-uninstall","title":"2.\u5e94\u7528 <code>uninstall</code> \u6587\u4ef6\u4e0b\u7684\u914d\u7f6e","text":"<p>\u5b8c\u6210\u4e0a\u8ff0\u6b65\u9aa4\u5e76\u4fdd\u5b58 ClusterOperation.yml \u6587\u4ef6\u540e\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>$ kubectl apply -f examples/uninstall/\n</code></pre> <p>\u81f3\u6b64\uff0c\u60a8\u5df2\u7ecf\u4f7f\u5b8c\u6210\u4e86\u4e00\u4e2a\u96c6\u7fa4\u7684\u5378\u8f7d\u3002</p>"},{"location":"usage/upgrade/","title":"\u96c6\u7fa4\u7248\u672c\u5347\u7ea7","text":"<p>\u672c\u8282\u5c06\u5411\u60a8\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528 kubean \u5347\u7ea7\u96c6\u7fa4\u7684 kubernnetes \u7248\u672c\u3002\u5728\u60a8\u514b\u9686\u81f3\u672c\u5730\u7684 <code>kubean/example/upgrade</code> \u6587\u4ef6\u5185\uff0c\u540c\u6837\u63d0\u4f9b\u4e86\u96c6\u7fa4\u7248\u672c\u5347\u7ea7\u7684\u6837\u4f8b\u6a21\u7248\uff1a</p>  upgrade \u6587\u4ef6\u5185\u4e3b\u8981\u7684\u914d\u7f6e\u6587\u4ef6\u53ca\u7528\u9014\u5982\u4e0b\uff1a <pre><code>    upgrade\n\u251c\u2500\u2500 ClusterOperation.yml                  # \u5347\u7ea7\u96c6\u7fa4\u4efb\u52a1\n\u2514\u2500\u2500 VarsConfCM.yml                        # \u96c6\u7fa4\u5347\u7ea7\u7248\u672c\u7b49\u53c2\u6570\u914d\u7f6e\n</code></pre> <p>\u4e0b\u9762\u4ee5\u4f7f\u7528 all-in-one \u6a21\u5f0f\u90e8\u7f72\u7684\u5355\u8282\u70b9\u96c6\u7fa4\u4e3a\u4f8b\uff0c\u6765\u6f14\u793a\u96c6\u7fa4\u7248\u672c\u5347\u7ea7\u64cd\u4f5c\u3002</p> <p>\u6ce8\u610f\uff1a\u6267\u884c\u96c6\u7fa4\u7248\u672c\u5347\u7ea7\u524d\uff0c\u60a8\u5fc5\u987b\u5df2\u7ecf\u4f7f\u7528 kubean \u5b8c\u6210\u4e86\u4e00\u5957\u96c6\u7fa4\u7684\u90e8\u7f72\u3002</p>"},{"location":"usage/upgrade/#1","title":"1. \u65b0\u589e\u5347\u7ea7\u4efb\u52a1","text":"<p>\u8fdb\u5165 <code>kubean/examples/upgrade/</code> \u8def\u5f84\uff0c\u7f16\u8f91\u6a21\u7248 <code>ClusterOperation.yml</code>\uff0c\u5c06\u4e0b\u5217\u53c2\u6570\u66ff\u6362\u4e3a\u60a8\u7684\u771f\u5b9e\u53c2\u6570\uff1a</p> <ul> <li><code>&lt;TAG&gt;</code>\uff1akubean \u955c\u50cf\u7248\u672c\uff0c\u63a8\u8350\u4f7f\u7528\u6700\u65b0\u7248\u672c\uff0c\u53c2\u9605 kubean \u7248\u672c\u5217\u8868\u3002</li> </ul> <p><code>kubean/examples/upgrade/</code> \u8def\u5f84\u4e0b <code>ClusterOperation.yml</code> \u7684\u6a21\u7248\u5185\u5bb9\u5982\u4e0b\uff1a</p> <p><pre><code>apiVersion: kubean.io/v1alpha1\nkind: ClusterOperation\nmetadata:\nname: cluster-mini-upgrade-ops\nspec:\ncluster: cluster-mini\nimage: ghcr.m.daocloud.io/kubean-io/spray-job:&lt;TAG&gt; # Please replace &lt;TAG&gt; with the specified version, such as v0.4.9\nbackoffLimit: 0\nactionType: playbook\naction: upgrade-cluster.yml\n</code></pre> \u91cd\u8981\u53c2\u6570\uff1a</p> <ul> <li><code>spec.cluster</code>: \u6307\u5b9a\u9700\u8981\u5347\u7ea7\u7684\u96c6\u7fa4\u540d\u79f0\uff0c\u4e0a\u8ff0\u6307\u5b9a\u7684\u662f\u540d\u4e3a <code>cluster-mini</code> \u7684\u96c6\u7fa4\u4e3a\u5347\u7ea7\u76ee\u6807\u3002</li> <li><code>spec.action:</code> \u6307\u5b9a\u5347\u7ea7\u76f8\u5173\u7684 kubespray \u5267\u672c, \u8fd9\u91cc\u8bbe\u7f6e\u4e3a <code>upgrade-cluster.yml</code>\u3002</li> </ul>"},{"location":"usage/upgrade/#2","title":"2. \u6307\u5b9a\u96c6\u7fa4\u5347\u7ea7\u7248\u672c","text":"<p>\u8fdb\u5165 <code>kubean/examples/upgrade/</code> \u8def\u5f84\uff0c\u7f16\u8f91\u6a21\u7248 <code>VarsConfCM.yml</code>\uff0c\u901a\u8fc7\u914d\u7f6e <code>kube_version</code> \u53c2\u6570\uff0c\u6307\u5b9a\u96c6\u7fa4\u5347\u7ea7\u7684\u7248\u672c\u3002</p> <p><code>kubean/examples/upgrade/</code> \u8def\u5f84\u4e0b <code>VarsConfCM.yml</code> \u7684\u6a21\u7248\u5185\u5bb9\u5982\u4e0b\uff1a</p> <p><pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\nname: mini-vars-conf\nnamespace: kubean-system\ndata:\ngroup_vars.yml: |\nkube_version: v1.25.8\n# upgrade_cluster_setup: true\n# upgrade_node_confirm: true\n# upgrade_node_pause_seconds: 60\n\ncontainer_manager: containerd\nkube_network_plugin: calico\netcd_deployment_type: kubeadm\n</code></pre> \u91cd\u8981\u53c2\u6570\uff1a</p> <ul> <li><code>kube_version</code>: \u6307\u5b9a\u9700\u8981\u5347\u7ea7\u7684\u96c6\u7fa4\u7248\u672c, \u4e0a\u8ff0\u6307\u5b9a\u4e86\u8981\u5347\u7ea7\u5230 k8s v1.25.8 \u7248\u672c\u3002</li> </ul> <p>\u5347\u7ea7\u96c6\u7fa4\u7248\u672c\u53c2\u6570\u7684\u793a\u4f8b</p> \u5347\u7ea7\u7248\u672c\u524d\u5347\u7ea7\u7248\u672c\u540e <pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\nname: mini-vars-conf\nnamespace: kubean-system\ndata:\ngroup_vars.yml: |\nkube_version: v1.25.0\n# upgrade_cluster_setup: true\n# upgrade_node_confirm: true\n# upgrade_node_pause_seconds: 60\n\ncontainer_manager: containerd\nkube_network_plugin: calico\netcd_deployment_type: kubeadm\n</code></pre> <pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\nname: mini-vars-conf\nnamespace: kubean-system\ndata:\ngroup_vars.yml: |\nkube_version: v1.25.8\n# upgrade_cluster_setup: true\n# upgrade_node_confirm: true\n# upgrade_node_pause_seconds: 60\n\ncontainer_manager: containerd\nkube_network_plugin: calico\netcd_deployment_type: kubeadm\n</code></pre> <p>\u9644\uff1akubean \u96c6\u7fa4\u7248\u672c\u652f\u6301\u673a\u5236\uff1a</p> kubean \u7248\u672c \u63a8\u8350\u7684 kubernetes \u7248\u672c \u652f\u6301\u7684 kubernetes \u7248\u672c\u8303\u56f4 v0.5.2 v1.25.4 - \"v1.27.2\"        - \"v1.26.5\"        - \"v1.26.4\"        - \"v1.26.3\"        - \"v1.26.2\"        - \"v1.26.1\"        - \"v1.26.0\"        - \"v1.25.10\"        - \"v1.25.9\"        - \"v1.25.8\"        - \"v1.25.7\"        - \"v1.25.6\"        - \"v1.25.5\"        - \"v1.25.4\"        - \"v1.25.3\"        - \"v1.25.2\"        - \"v1.25.1\"        - \"v1.25.0\" <p>\u66f4\u591a\u5347\u7ea7\u64cd\u4f5c\u53c2\u6570\u7684\u8be6\u7ec6\u8bf4\u660e\uff0c\u8bf7\u53c2\u8003 kubespray \u6587\u6863\uff1a\u901a\u8fc7Kubespray \u66f4\u65b0 kubernetes\u3002</p>"},{"location":"usage/upgrade/#3-upgrade","title":"3.\u5e94\u7528 <code>upgrade</code> \u6587\u4ef6\u4e0b\u6240\u6709\u7684\u914d\u7f6e","text":"<p>\u5b8c\u6210\u4e0a\u8ff0\u6b65\u9aa4\u5e76\u4fdd\u5b58 ClusterOperation.yml \u548c VarsConfCM.yml \u6587\u4ef6\u540e\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>$ kubectl apply -f examples/upgrade/\n</code></pre> <p>\u81f3\u6b64\uff0c\u60a8\u5df2\u7ecf\u4f7f\u5b8c\u6210\u4e86\u4e00\u4e2a\u96c6\u7fa4\u7684 kuberntes \u7248\u672c\u7684\u5347\u7ea7\u3002</p>"}]}